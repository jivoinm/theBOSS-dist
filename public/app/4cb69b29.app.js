"use strict";angular.module("theBossApp",["ngCookies","ngResource","ngSanitize","btford.socket-io","ui.router","ui.bootstrap","ui.calendar","toaster","angularMoment","underscore","ngDragDrop","angularFileUpload"]).config(["$stateProvider","$urlRouterProvider","$locationProvider","$httpProvider",function(a,b,c,d){b.otherwise("/"),c.html5Mode(!0).hashPrefix("!"),d.interceptors.push("authInterceptor")}]).constant("theBossSettings",{orderChangedEvent:"order-changed",userAutoCompleteSelectedEvent:"user-selected",previewModeEvent:"preview-mode",timeZone:"-05:00",taskStatuses:{New:"new",InProgress:"in progress",Finished:"finished",Blocked:"blocked"}}).factory("authInterceptor",["$rootScope","$q","$cookieStore","$location",function(a,b,c,d){return{request:function(a){return a.headers=a.headers||{},c.get("token")&&(a.headers.Authorization="Bearer "+c.get("token")),a},responseError:function(a){return 401===a.status?(d.path("/login"),c.remove("token"),b.reject(a)):b.reject(a)}}}]).run(["$rootScope","$location","Auth",function(a,b,c){a.$on("$stateChangeStart",function(a,d){c.isLoggedInAsync(function(a){d.authenticate&&!a&&b.path("/login")})})}]),angular.module("theBossApp").config(["$stateProvider",function(a){a.state("login",{url:"/login",templateUrl:"app/account/login/login.html",controller:"LoginCtrl"}).state("signup",{url:"/signup",templateUrl:"app/account/signup/signup.html",controller:"SignupCtrl"}).state("users",{url:"/user",templateUrl:"app/account/user/user.html",controller:"UserCtrl"}).state("usersByRole",{url:"/user/:role",templateUrl:"app/account/user/user.html",controller:"UserCtrl"}).state("settings",{url:"/settings",templateUrl:"app/account/settings/settings.html",controller:"SettingsCtrl",authenticate:!0})}]),angular.module("theBossApp").controller("LoginCtrl",["$scope","Auth","$location","$window",function(a,b,c,d){a.user={},a.errors={},a.login=function(d){a.submitted=!0,d.$valid&&b.login({email:a.user.email,password:a.user.password}).then(function(){c.path("/")})["catch"](function(b){a.errors.other=b.message})},a.loginOauth=function(a){d.location.href="/auth/"+a}}]),angular.module("theBossApp").controller("SettingsCtrl",["$scope","timeOff","Auth","ModalService","toaster",function(a,b,c,d,e){a.errors={},a.changePassword=function(b){a.submitted=!0,b.$valid&&c.changePassword(a.user.oldPassword,a.user.newPassword).then(function(){a.message="Password successfully changed."})["catch"](function(){b.password.$setValidity("mongoose",!1),a.errors.other="Incorrect password",a.message=""})},a.currentUser=c.getCurrentUser(),b.query(function(b){a.timeoffs=b}),a["delete"]=function(b,c){d.confirm.question("Delete "+c.detail+"?",function(d){d?c.$delete(function(){a.timeoffs.splice(b,1)}):a.order.date_required=null})()},a.approveToggle=function(a,b){b&&b.$save(function(a){e.pop("success","Success","Time off was "+(b.approved?"approved":"declined"))})},a.addNewRequest=function(c){a.submitted=!0,c.$valid&&(a.timeoff=new b(a.timeoff),a.timeoff.createdBy={},a.timeoff.createdBy.user_id=a.currentUser._id,a.timeoff.createdBy.name=a.currentUser.name,a.timeoff.createdBy.email=a.currentUser.email,a.timeoff.$save(function(b){a.timeoffs.push(b),a.timeoff={}}))}}]),angular.module("theBossApp").controller("SignupCtrl",["$scope","Auth","$location","$window",function(a,b,c,d){a.user={},a.errors={},a.register=function(d){if(a.submitted=!0,d.$valid){var e={owner:"DelPriore",name:a.user.name,email:a.user.email,role:a.user.role,password:a.user.password};b.createUser(e).then(function(){c.path("/user")})["catch"](function(b){b=b.data,a.errors={},angular.forEach(b.errors,function(b,c){d[c].$setValidity("mongoose",!1),a.errors[c]=b.message})})}},a.loginOauth=function(a){d.location.href="/auth/"+a}}]),angular.module("theBossApp").controller("UserCtrl",["$scope","User","$stateParams",function(a,b,c){a.$parent.pageHeader="Users",a.users=[];var d={};c.role&&(d.role=c.role),a.loadUsers=function(){a.queryText&&(d.text=a.queryText),b.query(d).$promise.then(function(b){a.users=b},function(a){})},a.loadUsers(),a.changRole=function(a,b){a.role=b,a.$updateRole()},a["delete"]=function(b,c){b.$delete(function(){a.users.splice(c,1)})}}]),angular.module("theBossApp").controller("AdminCtrl",["$scope","$http","Auth","User",function(a,b,c,d){a.users=d.query(),a["delete"]=function(b){d.remove({id:b._id}),angular.forEach(a.users,function(c,d){c===b&&a.users.splice(d,1)})}}]),angular.module("theBossApp").config(["$stateProvider",function(a){a.state("admin",{url:"/admin",templateUrl:"app/admin/admin.html",controller:"AdminCtrl",authenticate:!0})}]),angular.module("theBossApp").controller("CalendarCtrl",["$scope","OrderService","toaster","ModalService","moment","theBossSettings","roles","$location","$stateParams","Auth","$compile","$timeout","timeOff","uiCalendarConfig",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){function o(a){var c={orderId:a.order_id,property:a.update_date,date:e(a.start).zone(f.timeZone).format()};b.setdate_required(c)}a.$parent.pageHeader="Calendar",a.queryText="",a.uiCalendarConfig=n,a.loadOrders=function(){a.uiCalendarConfig.calendars.myCalendar.fullCalendar("refetchEvents")};var p=new Date;p.getDate(),p.getMonth(),p.getFullYear();a.getLabelColor=function(a){return a?"approved"==a.toLowerCase()?"#777":"finished"==a.toLowerCase()?"#5cb85c":"in progress"==a.toLowerCase()?"#337ab7":"installation"==a.toLowerCase()?"#000000":"shipped"==a.toLowerCase()?"#B4AA5B":"blocked"==a.toLowerCase()||"service"===a.toLowerCase()?"#d9534f":"#f0ad4e":"label label-warning"},a.LoadOrders=function(d,g,h,j){var k={};a.queryText&&(k.text=a.queryText);var l=[];return"service"===i.section?void j(l):(k.status=i.status,k.from=e(d).zone(f.timeZone).format("YYYY-MM-DD"),k.to=e(g).zone(f.timeZone).format("YYYY-MM-DD"),void b.getOrders(k).$promise.then(function(b){angular.forEach(b,function(b){try{b.shipped_date||this.push(a.createEvent("date_required",b,b._id,(b.installation_date?"(Chg)":"")+"["+b.po_number+"] "+b.customer.name+" "+(b.doors||""),b.date_required,a.getLabelColor(b.status),"Order")),b.installation_date&&b.installation_date!==b.date_required&&this.push(a.createEvent("installation_date",b,b._id,"["+b.po_number+"] "+b.customer.name+" "+(b.doors||""),b.installation_date,a.getLabelColor("installation"),"Order")),b.shipped_date&&this.push(a.createEvent("shipped_date",b,b._id,"["+b.po_number+"] "+b.customer.name+" "+(b.doors||""),b.shipped_date,a.getLabelColor("shipped"),"Order"))}catch(c){console.log("error loading this order",b,c)}},l),j(l)},function(a){c.pop("error","Error","Error loading orders "+a),console.log(a)}))},a.LoadServices=function(c,d,g,h){var j={};a.queryText&&(j.text=a.queryText);var k=[];return"jobs"===i.section?void h(k):(j.approved=i.approved,j.completed=i.completed,j.from=e(c).zone(f.timeZone).format("YYYY-MM-DD"),j.to=e(d).zone(f.timeZone).format("YYYY-MM-DD"),void b.getOrderServices(j).$promise.then(function(b){angular.forEach(b,function(b){b.services&&b.services.length>0&&angular.forEach(b.services,function(c,d){var e=c.completed?"[completed]":c.approved?"[approved]":"[new]";k.push(a.createEvent("services."+d+".date",c,b._id,"Service "+e+"-["+b.po_number+"] "+b.customer.name,c.date,a.getLabelColor("service"),"Service"))})},k),h(k)}))},a.LoadTimeOffs=function(b,c,d,e){var f={dateFrom:b,dateTo:c,approved:!0};a.queryText&&(f.text=a.queryText);var g=[];m.getTimeOff(f).$promise.then(function(b){angular.forEach(b,function(b){var c="Statutory holiday"==b.type?b.detail:b.createdBy.name+" - "+b.type;g.push(a.createEventOff(c,b.from,b.to))}),e(g)})},a.createEventOff=function(a,b,c){var d={title:a,start:b,end:c,color:"#CABDBF",allDay:!0,editable:!1};return d},a.createEvent=function(a,b,c,d,e,f,g){var h={};return h.order_id=c,h.title=d,h.start=e,h.end=e,h.color=f,h.className=g,h.update_date=a,h.item=b,h.allDay=!0,h.editable=!0,h},a.eventDrop=function(a,b,c,d){o(a)},a.eventClick=function(a){if(a.editable){a.details;b.get({orderId:a.order_id}).$promise.then(function(a){d.show.showOrderDetailsPopup("Event details",a)()},function(a){d.showPopup("Error loading event details",a)})}},a.eventResize=function(a,b,c,d){o(a)},a.eventRender=function(a,b,c){l(function(){$(b).attr("title",a.title)})},a.uiConfig={calendar:{header:{left:"today prev,next",center:"title",right:"month,basicWeek"},editable:g.validateRoleAdmin(j.getCurrentUser()),eventClick:a.eventClick,eventDrop:a.eventDrop,eventResize:a.eventResize,eventRender:a.eventRender}},a.yearView=function(){var b=a.myCalendar.fullCalendar("getView");d.showPopup("Event details "+b.title,"")},a.eventSources=[a.LoadOrders,a.LoadServices,a.LoadTimeOffs],i.status&&(a.orderStatus=i.status)}]),angular.module("theBossApp").config(["$stateProvider",function(a){a.state("calendar",{url:"/calendar",templateUrl:"app/calendar/calendar.html",controller:"CalendarCtrl",authenticate:!0}).state("calendar.section",{url:"/:section",templateUrl:"app/calendar/calendar-status.html",controller:"CalendarCtrl",authenticate:!0}).state("calendar.status",{url:"/:section/:status",templateUrl:"app/calendar/calendar-status.html",controller:"CalendarCtrl",authenticate:!0}).state("calendar.service",{url:"/:section/:approved/:completed",templateUrl:"app/calendar/calendar-services.html",controller:"CalendarCtrl",authenticate:!0})}]),angular.module("theBossApp").controller("FormCtrl",["$scope",function(a){a.message="Hello"}]),angular.module("theBossApp").config(["$stateProvider",function(a){a.state("form",{url:"/form",templateUrl:"app/form/form.html",controller:"FormCtrl",authenticate:!0})}]),angular.module("theBossApp").controller("MainCtrl",function(){}),angular.module("theBossApp").config(["$stateProvider",function(a){a.state("main",{url:"/",templateUrl:"app/main/main.html",controller:"MainCtrl",authenticate:!0})}]),angular.module("theBossApp").controller("OrderDetailCtrl",["$scope","$location","OrderService","ModalService","toaster","roles","datepickerConfig","$timeout","order","timeOff","$filter","theBossSettings",function(a,b,c,d,e,f,g,h,i,j,k,l){a.actives={},a.getOrderName=function(){var b="New Order";return a.order&&a.order._id&&(b="["+(a.order.po_number?a.order.po_number:"##")+"] "+(a.order.customer?a.order.customer.name:"???")),b},a.order=i,a.orderOriginal={},a.preview=!1,a.$parent.pageHeader=a.getOrderName();var m=null;a.order&&a.order._id&&(a.preview=!0),a.isActiveTab=function(b){return a.selectedTab===b},a.selectTab=function(b){a.selectedTab=b},a.isNewOrder=function(){return!a.order._id},a.edit=function(){a.preview=!1},a.redirectToList=function(){b.path("/orders")},a.saveOrder=function(){a.order.$save(function(b){a.order._id?a.redirectToList():a.order=b,e.pop("success","Success","Saved you order "+a.getOrderName())},function(a){e.pop("error","Error","Error saving you order "+a)})},a.save=function(b){(b.$valid||a.order._id)&&(!f.validateRoleAdmin()&&a.order.ordered_accessories&&0===a.order.ordered_accessories.length?d.confirm.question("Do you want to add accesories to this order?",function(b){return b?void(a.actives.two=!0):void a.saveOrder()})():a.saveOrder())},a["delete"]=function(){d.confirm["delete"](function(){a.order.$delete(function(){a.redirectToList(),e.pop("success","Success","Deleted you order "+a.getOrderName())},function(a){e.pop("error","Error","Error deleting order "+a)})})(a.getOrderName()+" order")},a.today=function(){a.dt=new Date},a.today(),a.clear=function(){a.dt=null},a.disabled=function(a,b){return"day"===b&&(0===a.getDay()||6===a.getDay())},a.minDate=a.order?a.order.date_required:null,g.minDate=a.minDate,a.toggleMin=function(){a.minDate=a.minDate?null:new Date},a.toggleMin(),a.open=function(b){b.preventDefault(),b.stopPropagation(),a.opened=!0},a.dateOptions={formatYear:"yy",startingDay:1},a.formats=["dd-MMMM-yyyy","yyyy/MM/dd","dd.MM.yyyy","shortDate"],a.format=a.formats[0],a.updateOrderOnChange=function(b,c,d){b!==c&&(m?(h.cancel(m),m=null):m=h(function(){a.order.$save(function(b){a.order=b,e.pop("success","Success",d)},function(a){e.pop("error","Error","Error saving you order "+a)})},1e3))},a.$watch("order.installation_date",function(b,c){a.updateOrderOnChange(b,c,"Saved installation date")},!0),a.$on(l.userAutoCompleteSelectedEvent,function(b,c){var d="Successfully saved "+c.fieldName+" to "+c.value;a.updateOrderOnChange(1,0,d)},!0),a.$watch("order.date_required",function(b,c){b!==c&&b&&!a.order._id&&j.check({date:b}).$promise.then(function(b){if(b.length>0){var c="There are time offs for this period:<br>";angular.forEach(b,function(a){var b=k("date")(a.from),d=k("date")(a.to);c+=("Statutory holiday"===a.type?a.detail:a.createdBy.name)+" - "+a.type+" - "+b+" - "+d+"<br>"}),c+="<strong>Continue?</strong>",d.confirm.question(c,function(b){b||(a.order.date_required=null)})()}},function(a){e.pop("error","Error","Error loading time off "+a)})},!0)}]),angular.module("theBossApp").controller("OrderListCtrl",["$scope","OrderService","$stateParams",function(a,b,c){a.$parent.pageHeader="Orders",a.orders=[],a.totalOrders=0,a.currentPage=1,a.maxSize=10,c.status&&(a.orderStatus=c.status),a.loadOrders=function(){var c={};a.orderStatus&&(c.status=a.orderStatus),a.queryText&&(c.text=a.queryText),c.limit=a.maxSize=10,c.page=a.currentPage,b.query(c).$promise.then(function(b){a.orders=b.orders,a.currentPage=b.page,a.totalOrders=b.totalOrders})},a.loadOrders(),a.$watch("currentPage",function(b,c){b!=c&&(a.loadOrders(),console.log("currentPage changed",b,c))})}]),angular.module("theBossApp").controller("OrderPrintCtrl",["$scope","order","$stateParams","$window","$filter","ModalService","toaster",function(a,b,c,d,e,f,g){var h=b.services[c.action];a.action=h?h.title:"Installation",a.date=h?h.date:b.installation_date,a.done_by=h?h.done_by:b.installation_by,a.details=h?h.details:"",a.order=b,a.getFormDate=function(){return e("date")(a.date)};var i=[{title:"Date",type:"date",require:!0,value:a.date},{title:"Done By",type:"user",require:!0,value:a.done_by,show_options:"worker"}];a.print=function(){f.show.modalFormDialog("Confirm service date",i,function(e){e&&b&&(b.$save||(b=new OrderService(b)),h?(b.services[c.action].date=e.date,b.services[c.action].done_by=e.done_by):(b.installation_date=e.date,b.installation_by=e.done_by),a.date=e.date,a.done_by=e.done_by,b.$save(function(a){g.pop("success","Service form sent to printer with success"),d.print(),d.history.back()},function(a){g.pop("error","There was an error saving service on server, "+a.message)}))})()}}]),angular.module("theBossApp").controller("OrderServicesCtrl",["$scope","OrderService","$stateParams",function(a,b,c){a.getOrderName=function(a){var b="";return a&&a._id&&(b="["+(a.po_number?a.po_number:"##")+"] "+(a.customer?a.customer.name:"???")),b},c.status?a.serviceStatus=c.status:a.serviceStatus=null,a.loadOrders=function(){var c={};a.serviceStatus&&(c.status=a.serviceStatus),a.queryText&&(c.text=a.queryText),c.limit=a.maxSize=10,c.page=a.currentPage,b.services(c).$promise.then(function(b){a.orders=b.orders,a.currentPage=b.page,a.totalOrders=b.totalOrders})},a.loadOrders(),a.$watch("currentPage",function(b,c){b!=c&&(a.loadOrders(),console.log("currentPage changed",b,c))})}]),angular.module("theBossApp").controller("OrderCtrl",function(){}),angular.module("theBossApp").config(["$stateProvider",function(a){a.state("order",{url:"/order",templateUrl:"app/order/order.html",authenticate:!0}).state("order.list",{url:"/list",templateUrl:"app/order/order-list/order-list.html",controller:"OrderListCtrl",authenticate:!0}).state("order.status",{url:"/list/:status",templateUrl:"app/order/order-list/order-list.html",controller:"OrderListCtrl",authenticate:!0}).state("order.services",{url:"/services",templateUrl:"app/order/order-services/order-services.html",controller:"OrderServicesCtrl",authenticate:!0}).state("order.services-status",{url:"/services/:status",templateUrl:"app/order/order-services/order-services.html",controller:"OrderServicesCtrl",authenticate:!0}).state("order.new",{url:"/detail",templateUrl:"app/order/order-detail/order-detail.html",resolve:{OrderService:"OrderService",order:["OrderService","$stateParams",function(a,b){return b.id?new a:new a({})}]},controller:"OrderDetailCtrl",authenticate:!0}).state("order.detail",{url:"/detail/:id/:tab",templateUrl:"app/order/order-detail/order-detail.html",resolve:{OrderService:"OrderService",order:["OrderService","$stateParams",function(a,b){return b.id?a.get({orderId:b.id}).$promise.then(function(a){return a}):new a({})}]},controller:"OrderDetailCtrl",authenticate:!0}).state("order.print",{url:"/detail/:id/print/:action",templateUrl:"app/order/order-print/order-print.html",resolve:{OrderService:"OrderService",order:["OrderService","$stateParams",function(a,b){return b.id?a.get({orderId:b.id}).$promise.then(function(a){return a}):new a({})}]},controller:"OrderPrintCtrl",authenticate:!0})}]),angular.module("theBossApp").factory("Auth",["$location","$rootScope","$http","User","$cookieStore","$q",function(a,b,c,d,e,f){var g={};return e.get("token")&&(g=d.get()),{login:function(a,b){var h=b||angular.noop,i=f.defer();return c.post("/auth/local",{email:a.email,password:a.password}).success(function(a){return e.put("token",a.token),g=d.get(),i.resolve(a),h()}).error(function(a){return this.logout(),i.reject(a),h(a)}.bind(this)),i.promise},logout:function(){e.remove("token"),g={}},createUser:function(a,b){var c=b||angular.noop;return d.save(a,function(b){return c(a)},function(a){return this.logout(),c(a)}.bind(this)).$promise},changePassword:function(a,b,c){var e=c||angular.noop;return d.changePassword({id:g._id},{oldPassword:a,newPassword:b},function(a){return e(a)},function(a){return e(a)}).$promise},getCurrentUser:function(){return g},isLoggedIn:function(){return g.hasOwnProperty("role")},isLoggedInAsync:function(a){g.hasOwnProperty("$promise")?g.$promise.then(function(){a(!0)})["catch"](function(){a(!1)}):a(g.hasOwnProperty("role")?!0:!1)},isAdmin:function(){return"admin"===g.role},getToken:function(){return e.get("token")}}}]),angular.module("theBossApp").factory("User",["$resource",function(a){return a("/api/users/:id/:controller",{id:"@_id"},{query:{method:"GET",isArray:!0},changePassword:{method:"PUT",params:{controller:"password"}},get:{method:"GET",params:{id:"me"}},updateRole:{method:"POST",url:"/api/users/:id/:role",params:{id:"@_id",role:"@role"}}})}]),angular.module("theBossApp").directive("accessories",["OrderService","toaster",function(a,b){return{restrict:"E",templateUrl:"components/directives/accessories/accessories.html",scope:!1,link:function(c){c.orders=[],c.totalOrders=0,c.currentPage=1,c.maxSize=10,c.notreceived={received:!1},c.loadAccessories=function(){var b={};b.limit=c.maxSize=10,b.page=c.currentPage,a.accessories(b).$promise.then(function(a){c.orders=a.orders,c.totalOrders=a.totalOrders})},c.saveUpdates=function(c,d,e){e.items_received?(e.received=e.items_received>=e.quantity,e.date_received=new Date,d.$save||(d=new a(d)),d.$save(function(){e.received?(d.ordered_accessories.splice(c,1),b.pop("success","Success","Received all "+e.description)):b.pop("success","Success","Updated items received for "+e.description)})):b.pop("error","Error","Nothing was set as received.")},c.loadAccessories(),c.$watch("currentPage",function(a,b){a!=b&&c.loadAccessories()})}}}]),angular.module("theBossApp").directive("activeUrl",["$location",function(a){return{restrict:"A",link:function(b,c){if(c[0].href){var d=c[0].href.replace("#","");a.path()===d?c.addClass("active"):c.removeClass("active")}}}}]),angular.module("theBossApp").directive("alerts",["Auth","roles","timeOff","$interval",function(a,b,c,d){function e(a,b,c,d){return{type:a,icon:b,message:c,url:d}}return{templateUrl:"components/directives/alerts/alerts.html",restrict:"EA",replace:!0,link:function(f,g,h){f.checkForUpdates=function(){f.alerts=[],b.validateRoleAdmin(a.getCurrentUser())&&c["new"]().$promise.then(function(a){a.total>0&&f.alerts.push(e("Time Off","icon-time","There are "+a.total+" to approve","/settings"))})},f.checkForUpdates(),d(f.checkForUpdates,1e4)}}}]),angular.module("theBossApp").directive("fieldUpload",["$upload","$timeout","$rootScope","theBossSettings","toaster",function(a,b,c,d,e){return{templateUrl:"components/directives/field-upload/field-upload.html",restrict:"E",scope:{model:"="},link:function(f,g,h){f.preview=h.preview||f.$parent.preview,c.$on(d.previewModeEvent,function(a,b){f.preview=b}),f.encodeFileName=function(a){return encodeURIComponent(a)},f.deleteFile=function(a,b,c){f.model.uploaded_files.splice(b,1),f.model.$save(function(){e.pop("success","Success","Delete file "+a.filename)})},h.uploadUrl?(f.model=f.model||{},f.uploadRightAway=!0,f.hasUploader=function(a){return null!=f.upload[a]},f.hasUploadingInProgress=function(){angular.forEach(f.progress,function(a){return 100>a})},f.abort=function(a){f.upload[a].abort(),f.upload[a]=null},f.onFileSelect=function(a){if(f.progress=[],f.upload&&f.upload.length>0)for(var c=0;c<f.upload.length;c++)null!=f.upload[c]&&f.upload[c].abort();f.upload=[],f.selectedFiles=a,f.dataUrls=[];for(var c=0;c<a.length;c++){var d=a[c];if(window.FileReader&&d.type.indexOf("image")>-1){var e=new FileReader;e.readAsDataURL(a[c]);(function(a,c){a.onload=function(a){b(function(){f.dataUrls[c]=a.target.result})}})(e,c)}f.progress[c]=-1,f.uploadRightAway&&f.start(c)}},f.start=function(b){f.progress[b]=0,f.errorMsg=null,f.upload[b]=a.upload({url:h.uploadUrl,method:"POST",file:f.selectedFiles[b]}).then(function(a){f.model.uploaded_files.push(a.data),f.model.$save(function(){f.progress[b]=100,e.pop("success","Success","Uploaded file with success "+a.data.filename)})},function(a){a.status>0&&(f.errorMsg=a.status+": "+a.data)},function(a){f.progress[b]=Math.min(100,parseInt(100*a.loaded/a.total))}).xhr(function(a){a.upload.addEventListener("abort",function(){console.log("abort complete")},!1)})},f.resetInputFile=function(){for(var a=document.getElementsByTagName("input"),b=0;b<a.length;b++)"file"==a[b].type&&(a[b].value=null)}):g.text("You need to set upload-url attribute")}}}]),angular.module("theBossApp").directive("field",["$http","$compile","$timeout","User","_","datepickerConfig","$rootScope","theBossSettings",function(a,b,c,d,e,f,g,h){function i(a,b,c){var i="";switch(a.field.type){case"date":a.today=function(){a.field.value=new Date},a.clear=function(){a.field.value=null},a.disabled=function(a,b){return"day"===b&&(0===a.getDay()||6===a.getDay())},a.toggleMin=function(){a.minDate=a.minDate?null:new Date},e.some(a.field.show_options,function(a){return a.showMinToday})&&(a.minDate=new Date,f.minDate=new Date);var k=e.some(a.field.show_options,function(a){return a.minDate});k&&(a.minDate=k,f.minDate=k),a.show_calendar=!1,a.openCalendar=function(b){b.preventDefault(),b.stopPropagation(),a.show_calendar=!0},a.dateOptions={formatYear:"yy",startingDay:1},a.initDate=new Date(a.field.value),a.format="dd-MMMM-yyyy",i='<div class="row"><div class="col-md-6"><p class="input-group"><input type="text" class="form-control" datepicker-append-to-body="false" datepicker-popup="{{ format }}" name="fieldName" placeholder="{{field.title}}"ng-model="model"  ng-required="{{ field.require }}" is-open="show_calendar" close-text="Close" min-date="minDate"/><span class="input-group-btn"><button type="button" class="btn btn-default" ng-click="openCalendar($event)"><i class="glyphicon glyphicon-calendar"></i></button></span></p></div></div>',i=j(i);break;case"text":i='<input type="text" class="form-control" name="fieldName" placeholder="{{field.title}}"ng-model="model"  ng-required="{{ field.require }}"/>',i=j(i);break;case"number":i='<input type="number" class="form-control" name="fieldName" placeholder="{{field.title}}"ng-model="model"  ng-required="{{ field.require }}"/>',i=j(i);break;case"hidden":i='<input type="hidden" class="form-control" name="fieldName" ng-model="model" />',i=i;break;case"password":i='<input type="password" class="form-control" name="fieldName" placeholder="{{field.title}}"ng-model="model"  ng-required="{{ field.require }}"/>',i=j(i);break;case"email":i='<div class="input-group"><span class="input-group-addon"><i class="fa fa-envelope-o fa-fw"></i></span><input type="email" class="form-control" name="fieldName" placeholder="{{field.title}}"ng-model="model" ng-required="{{ field.require }}"/></div>',i=j(i);break;case"user":a.field.show_options;a.getUsers=function(b){var c={name:b};return a.field.show_options&&(c.role=a.field.show_options),d.query(c).$promise.then(function(a){var b=[];return angular.forEach(a,function(a){b.push(a)}),b})},a.selectedUser=function(b,c,d){a.model={user_id:b._id,name:b.name,email:b.email},g.$broadcast(h.userAutoCompleteSelectedEvent,{fieldName:a.field.title,value:b.name})},i=' <input type="text" ng-model="model" placeholder="lookup user" typeahead-on-select="selectedUser($item, $model, $label)" typeahead="(user.name + \', \'+ user.email) for user in getUsers($viewValue)" typeahead-loading="loadingLocations" class="form-control"><i ng-show="loadingLocations" class="glyphicon glyphicon-refresh"></i>',i=j(i);break;case"select":i='<select name="fieldName" class="form-control" placeholder="{{field.title}}"ng-model="model"  ng-required="{{ field.require }}" ng-options="value for value in splitOptions(field.show_options)"ng-show="!editmode"><option value=""></option></select>',i=j(i);break;case"checkbox":i='<div class="checkbox"><label><input type="checkbox" name="fieldName" ng-model="model" ng-required="{{ field.require }}"></label></div>',i=j(i);break;case"radio":i='<div class="radio"> <div class="radio" ng-repeat="option in splitOptions(field.show_options)"><label><input type="radio" name="fieldName" ng-model="model" ng-value="option">{{ option }}</label></div></div>',i=j(i);break;case"textarea":i='<textarea class="form-control" rows="3" name="fieldName" placeholder="{{field.title}}"ng-model="model"  ng-required="{{ field.require }}"/>',i=j(i);break;case"tokens":i='<input type="text" class="form-control tokenfield" name="fieldName"ng-model="model" ng-required="{{ field.require }}"/>',i=j(i);break;case"composite":i='<div class="well"><div  field ng-model="composite_field.value" ng-field="composite_field" ng-repeat="composite_field in field.show_options"></div></div>',i=j(i)}return i}var j=function(a){return'<div ng-form="form" class="form-group" ng-class="{\'has-error\' :  form.fieldName.$invalid  }"><label class="control-label" ng-class="{\'col-sm-4\' : !isInine}">{{field.title}}</label><div class="col-sm-8" ng-class="{\'col-sm-6\' : !isInline}">'+a+'</div><div class="col-sm-2" ng-show="!isInline" restricted-access><div name="tools" ng-show="field._id" class="btn-group-xs pull-right" tooltip-placement="top" tooltip-append-to-body="true" tooltip="Edit or Delete {{field.title}}"><button type="button" class="btn btn-default fa fa-pencil" ng-click="edit(fieldForm,field,index)"></button><button type="button" class="btn btn-default fa fa-trash-o" ng-click="delete(fieldForm,field,index)"></button></div></div></div>'};return{restrict:"EA",scope:{model:"=ngModel",field:"=ngField",edit:"&","delete":"&",index:"=",preview:"@"},link:function(a,d,e,f){if(a.splitOptions=function(a){return"[object Array]"===Object.prototype.toString.call(a)?a:a?a.split(","):[]},a.field){var g=$(i(a,d,e)).appendTo(d);b(g)(a),"tokens"==a.field.type&&c(function(){d.find(".tokenfield").tokenfield({tokens:a.field.value})},700),a.field.focus===!0&&c(function(){d.find("input, select, textarea").focus()},700)}}}}]),angular.module("theBossApp").directive("fieldUpload",["$upload","$timeout","$rootScope","theBossSettings","toaster",function(a,b,c,d,e){return{templateUrl:"components/directives/field-upload/field-upload.html",restrict:"E",scope:{model:"="},link:function(f,g,h){f.preview=h.preview||f.$parent.preview,c.$on(d.previewModeEvent,function(a,b){f.preview=b}),f.encodeFileName=function(a){return encodeURIComponent(a)},f.deleteFile=function(a,b,c){f.model.uploaded_files.splice(b,1),f.model.$save(function(){e.pop("success","Success","Delete file "+a.filename)})},h.uploadUrl?(f.model=f.model||{},f.uploadRightAway=!0,f.hasUploader=function(a){return null!=f.upload[a]},f.hasUploadingInProgress=function(){angular.forEach(f.progress,function(a){return 100>a})},f.abort=function(a){f.upload[a].abort(),f.upload[a]=null},f.onFileSelect=function(a){if(f.progress=[],f.upload&&f.upload.length>0)for(var c=0;c<f.upload.length;c++)null!=f.upload[c]&&f.upload[c].abort();f.upload=[],f.selectedFiles=a,f.dataUrls=[];for(var c=0;c<a.length;c++){var d=a[c];if(window.FileReader&&d.type.indexOf("image")>-1){var e=new FileReader;e.readAsDataURL(a[c]);(function(a,c){a.onload=function(a){b(function(){f.dataUrls[c]=a.target.result})}})(e,c)}f.progress[c]=-1,f.uploadRightAway&&f.start(c)}},f.start=function(b){f.progress[b]=0,f.errorMsg=null,f.upload[b]=a.upload({url:h.uploadUrl,method:"POST",file:f.selectedFiles[b]}).then(function(a){f.model.uploaded_files.push(a.data),f.model.$save(function(){f.progress[b]=100,e.pop("success","Success","Uploaded file with success "+a.data.filename)})},function(a){a.status>0&&(f.errorMsg=a.status+": "+a.data)},function(a){f.progress[b]=Math.min(100,parseInt(100*a.loaded/a.total))}).xhr(function(a){a.upload.addEventListener("abort",function(){console.log("abort complete")},!1)})},f.resetInputFile=function(){for(var a=document.getElementsByTagName("input"),b=0;b<a.length;b++)"file"==a[b].type&&(a[b].value=null)}):g.text("You need to set upload-url attribute")}}}]),angular.module("theBossApp").directive("fileUploads",["$upload","$timeout","$rootScope","theBossSettings","toaster","OrderService",function(a,b,c,d,e,f){return{templateUrl:"components/directives/file-uploads/file-uploads.html",restrict:"E",scope:{model:"="},link:function(f,g,h){f.preview=h.preview||f.$parent.preview,c.$on(d.previewModeEvent,function(a,b){f.preview=b}),f.encodeFileName=function(a){return encodeURIComponent(a)},f.deleteFile=function(a,b,c){f.model.uploaded_files.splice(b,1),f.model.$save(function(){e.pop("success","Success","Delete file "+a.filename)})},h.uploadUrl?(f.model=f.model||{},f.uploadRightAway=!0,f.hasUploader=function(a){return null!=f.upload[a]},f.hasUploadingInProgress=function(){angular.forEach(f.progress,function(a){return 100>a})},f.abort=function(a){f.upload[a].abort(),f.upload[a]=null},f.onFileSelect=function(a){if(f.progress=[],f.upload&&f.upload.length>0)for(var c=0;c<f.upload.length;c++)null!=f.upload[c]&&f.upload[c].abort();f.upload=[],f.selectedFiles=a,f.dataUrls=[];for(var c=0;c<a.length;c++){var d=a[c];if(window.FileReader&&d.type.indexOf("image")>-1){var e=new FileReader;e.readAsDataURL(a[c]);(function(a,c){a.onload=function(a){b(function(){f.dataUrls[c]=a.target.result})}})(e,c)}f.progress[c]=-1,f.uploadRightAway&&f.start(c)}},f.start=function(b){f.progress[b]=0,f.errorMsg=null,f.upload[b]=a.upload({url:h.uploadUrl,method:"POST",file:f.selectedFiles[b]}).then(function(a){f.model.uploaded_files.push(a.data),f.model.$save(function(){f.progress[b]=100,e.pop("success","Success","Uploaded file with success "+a.data.filename)})},function(a){a.status>0&&(f.errorMsg=a.status+": "+a.data)},function(a){f.progress[b]=Math.min(100,parseInt(100*a.loaded/a.total))}).xhr(function(a){a.upload.addEventListener("abort",function(){console.log("abort complete")},!1)})},f.resetInputFile=function(){for(var a=document.getElementsByTagName("input"),b=0;b<a.length;b++)"file"==a[b].type&&(a[b].value=null)}):g.text("You need to set upload-url attribute")}}}]),angular.module("theBossApp").directive("focusMe",["$timeout",function(a){return function(b,c,d){b.$watch(d.focusMe,function(b){console.log("focus",b),b===!0&&a(function(){c[0].focus()},700)})}}]),angular.module("theBossApp").directive("forms",["FormService","ModalService","toaster",function(a,b,c){function d(a,b){angular.forEach(a,function(a,c){("value"!=c||null==b[c])&&(b[c]=a)})}var e=["text","number","email","password","radio","select","date","textarea","checkbox","hidden","composite"];return{templateUrl:"components/directives/form/form.html",restrict:"E",scope:{listOfForms:"="},controller:["$scope",function(f){
function g(a){return[{title:"Title",value:a.title,require:!0,type:"text"},{title:"Value",value:a.value,require:!1,type:"text"},{title:"Type",value:a.type,require:!0,type:"select",show_options:e},{title:"Show Options",value:a.show_options,require:!1,type:"tokens"},{title:"Require",value:a.require,require:!1,type:"checkbox"}]}function h(a){a&&(a.preventDefault(),a.stopPropagation())}f.addForm=function(a){f.listOfForms=f.listOfForms||[],f.listOfForms.push(angular.copy(a))},f.addField=function(e,f){h(f),b.show.modalFormDialog("Add new field ",g({}),function(b){a.addField({id:e._id},b,function(a){c.pop("success","Field "+b.title+" was added with success"),d(a,e)},function(a){c.pop("error","There was an error saving new field on server, "+a)})})()},f.editField=function(e,f){var h=[];angular.forEach(e.fields,function(a){this.push(a.title)},h),b.show.modalFormDialog("Edit field "+f.title,g(f),function(b){b&&(d(b,f),a.updateField({id:e._id,fieldId:f._id},f,function(a){c.pop("success","Field "+f.title+" was updated with success"),d(a,e)},function(a){c.pop("error","There was an error saving field on server, "+a.message)}))})()},f.addNewForm=function(d){h(d);var e=[];angular.forEach(f.moduleForms,function(a){this.push(a.formName)},e);var g=[{title:"Form Name",value:"",require:!0,type:"text"}];e.length>0&&g.push({title:"Clone From",value:"",require:!1,type:"select",show_options:e}),b.show.modalFormDialog("Add new form",g,function(b){var d={};b.clone_from&&angular.forEach(f.moduleForms,function(a){a.formName==b.clone_from&&(d=angular.copy(a),delete d._id)}),d.formName=b.formName,d.module=f.module,new a(d).$save(function(a){a?(c.pop("success","New form was added with success"),f.listOfForms.push(a),f.moduleForms.push(a)):c.pop("error","There was an error saving new form on server.")})})()},f.deleteForm=function(d,e,g){h(e),b.confirm.questionDelete("Are you sure you want to permanently delete "+d.formName+"?",function(b){if(b){var e=new a(d);e.$delete(function(){c.pop("success","Form was deleted with success"),f.listOfForms.splice(g,1),f.moduleForms.splice(f.moduleForms.indexOf(d),1)})}})()},f.deleteFormField=function(d,e,f){b.confirm.questionDelete("Are you sure you want to permanently delete "+e.title+"?",function(b){if(b){var g=new a(d);g.$deleteField({id:d._id,fieldId:e._id},function(a){c.pop("success","Form field was deleted with success"),d.fields.splice(f,1)})}})()},f.removeForm=function(a,c,d){h(d),b.confirm.questionDelete("Remove "+a[c].formName+" from this form?",function(b){b&&a.splice(c,1)})()}}],link:function(b,c,d){b.oneAtATime=!0,b.module=d.module,b.errors=[],b.moduleForms=[],b.preview=d.preview||b.$parent.preview,b.module&&a.get({module:b.module}).$promise.then(function(a){b.moduleForms=a},function(a){b.errors.push(a.message?a.message:a)}),b.status={isopen:!1},b.toggleDropdown=function(a){event.preventDefault(),event.stopPropagation(),b.status.isopen=!$scope.status.isopen}}}}]),angular.module("theBossApp").directive("newOrders",["OrderService",function(a){return{templateUrl:"components/directives/new-orders/new-orders.html",restrict:"E",scope:!0,link:function(b,c,d){b.totalOrders=0,b.orders=[];var e={};e.status="new",e.limit=null,e.page=null,a.query(e).$promise.then(function(a){b.orders=a.orders,b.totalOrders=a.totalOrders})}}}]),angular.module("theBossApp").directive("note",["Note","OrderService",function(a,b){return{templateUrl:"components/directives/note/note.html",restrict:"E",link:function(c,d,e){c.note={},c.saveNote=function(b){if(b&&c.note.order&&c.note.content){var d=new a(c.note);d.$save(function(a){c.note={},c.loadNotes()})}},c.loadOrders=function(a){return b.query({text:a,limit:10}).$promise.then(function(a){var b=[];return c.note.order=null,angular.forEach(a.orders,function(a){b.push(a)}),b})},c.selectedOrder=function(a,b,d){c.note.order=a._id}}}}]),angular.module("theBossApp").directive("notes",["Note","OrderService",function(a,b){return{templateUrl:"components/directives/notes/notes.html",restrict:"E",scope:!0,link:function(b,c,d){b.notes=[],b.loadNotes=function(){a.New().$promise.then(function(a){b.notes=a},function(a){console.log(a)})},b.loadNotes()}}}]),angular.module("theBossApp").directive("orderAccessories",["$rootScope","theBossSettings","ModalService","toaster",function(a,b,c,d){return{templateUrl:"components/directives/order/order-accessories/order-accessories.html",restrict:"E",scope:!0,link:function(e,f,g){return e.order?(a.$on(b.previewModeEvent,function(a,b){e.preview=b}),e.order_accessories_fields=[{title:"From Manufacturer",type:"text",require:!0,value:""},{title:"Description",type:"text",require:!0},{title:"Quantity",type:"number",require:!0}],void(e.addNewAccessory=function(a){c.show.modalFormDialog("Add new Accessory",e.order_accessories_fields,function(b){b&&(a&&(a.$save||(a=new OrderService(a)),a.ordered_accessories.unshift(b),a.$save(function(a){d.pop("success","Accessory was saved with success")},function(a){d.pop("error","There was an error saving service on server, "+a.message)})),b=null)})()})):void f.text("Missing order on the scope")}}}]),angular.module("theBossApp").directive("orderDetails",["$rootScope",function(a){return{templateUrl:"components/directives/order/order-details/order-details.html",restrict:"E",scope:{order:"="},link:function(){}}}]),angular.module("theBossApp").directive("quickList",["$http","ModalService","FormService","toaster","$rootScope",function(a,b,c,d,e){return{templateUrl:"components/directives/order/order-list/order-list.html",restrict:"E",transclude:!0,replace:!0,scope:{quickList:"=",itemSelect:"&",searchFilter:"=",listSearch:"&",listFieldsToEdit:"=",editableForm:"=",footerForm:"="},link:function(a,b,c){a.listType=c.listType||"list",a.title=c.title||"Quick list",a.selectedFilter={text:""},a.quickList=a.quickList||[],a.preview=c.preview||a.$parent.preview,a.selectedItem=null},controller:["$scope",function(c){var e=1,f=5;c.itemsLimit=function(){return f*e},c.hasMoreItemsToShow=function(){return c.quickList&&e<c.quickList.length/f},c.showMoreItems=function(){e+=1},c.lookup=function(b,d){return c.selectedFilter.itemId=null,d?a.get(d,{params:{name:b}}).then(function(a){var b=[];return angular.forEach(a.data,function(a){b.push(a)}),b}):b},c.selectedResult=function(a){c.selectedFilter.itemId=a._id},c.addNewField=function(a){b.show.modalFormDialog("Add new field",c.listFieldsToEdit,function(b){b&&(a&&a.$save&&(c.quickList.unshift(b),a.$save(function(a){d.pop("success","Field was saved with success")},function(a){d.pop("error","There was an error saving field on server, "+a.message)})),b=null)})()},c.selectItem=function(a){c.selectedItem=a,c.itemSelect(a)}}]}}]),angular.module("theBossApp").directive("orderNotes",["Note","ModalService","toaster","Auth",function(a,b,c,d){return{templateUrl:"components/directives/order/order-notes/order-notes.html",restrict:"E",link:function(d,e,f){return d.notes=[],d.order?(a.OrderNotes({orderid:d.order._id}).$promise.then(function(a){d.notes=a}),d.order_note_fields=[{title:"Content",type:"textarea",require:!0}],d.resolved=function(a){a.$save({},function(b){console.log(b),a.resolved=!0},function(b){console.log(b),a.resolved=!1})},d.addNewNote=function(){b.show.modalFormDialog("Add new Note",d.order_note_fields,function(b){b&&(b=new a(b),b.order=d.order._id,b.$save(function(a){c.pop("success","Note was saved with success"),d.notes.push(a)},function(a){c.pop("error","There was an error saving note on server, "+a.message)}),b=null)})()},void(d.deleteNote=function(a,c){var e="Are you sure you want to delete this note?";b.confirm.question(e,function(b){b&&c.$delete(function(){d.notes.splice(a,1)})})()})):void e.text("Missing order on the scope")}}}]),angular.module("theBossApp").directive("orderOptions",function(){return{template:'<div class="dropdown hidden">          <button class="btn btn-default btn-xs dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown">           <span class="glyphicon glyphicon-cog"></span>            <span class="caret"></span>        </button>            <ul class="dropdown-menu dropdown-menu-right" role="menu" aria-labelledby="dropdownMenu1">            </ul>            </div> ',restrict:"E",replace:!0,scope:{order:"="},link:function(a,b,c){b.parent().parent().bind("mouseenter",function(){b.removeClass("hidden")}),b.parent().parent().bind("mouseleave",function(){b.addClass("hidden")}),a.order&&"new"===a.order.status.toLowerCase()&&b.find("ul").append('<li role="presentation"><a role="menuitem" tabindex="-1" href="" ng-click="approveOrder({{ scope.order._id }})">Approve</a></li>')}}}),angular.module("theBossApp").directive("orderPreview",["$stateParams","$filter",function(a,b){return{templateUrl:"components/directives/order/order-preview/order-preview.html",restrict:"E",scope:{order:"="},controller:["$scope",function(b){b.preview=!0,b.tabs=[{title:"Forms",template:"components/directives/order/order-preview/tab-forms.html",active:!0},{title:"Services",template:"components/directives/order/order-preview/tab-services.html",active:!1},{title:"Accessories",template:"components/directives/order/order-preview/tab-accessories.html",active:!1},{title:"Files",template:"components/directives/order/order-preview/tab-files.html",active:!1},{title:"Notes",template:"components/directives/order/order-preview/tab-notes.html",active:!1}],a.tab&&angular.forEach(b.tabs,function(b){b.title===a.tab?b.active=!0:b.active=!1})}]}}]),angular.module("theBossApp").directive("orderServices",["$rootScope","theBossSettings","ModalService","toaster","$templateCache","$compile","OrderService",function(a,b,c,d,e,f,g){return{templateUrl:"components/directives/order/order-services/order-services.html",restrict:"E",link:function(a,b,e){return a.order?(a.order_service_fields=[{title:"Date",type:"date",require:!0},{title:"Details",type:"textarea",require:!0},{title:"Done By",type:"user",require:!1,show_options:"worker"}],a.completed=function(b,d){var e="Are you sure you want to "+(d.approved&&!d.completed?"approve":"complete")+" this service?";c.confirm.question(e,function(c){c?(b.$save||(b=new g(b)),b.$save(function(b){a.order=b})):(d.approved=d.approved&&!d.completed?!1:!0,d.completed=d.approved&&d.completed?!1:!1)})()},a["delete"]=function(b,d){var e="Are you sure you want to delete this service?";c.confirm.question(e,function(c){c&&(b.services.splice(d,1),b.$save||(b=new g(b)),b.$save(function(b){a.order=b}))})()},a.addNewService=function(b){var e=b.services?b.services.length+1:1;c.show.modalFormDialog("Add new Service #"+e,a.order_service_fields,function(a){a&&(b&&(b.$save||(b=new g(b)),a.title="Service #"+e,b.services.unshift(a),b.$save(function(a){d.pop("success","Service was saved with success")},function(a){d.pop("error","There was an error saving service on server, "+a.message)})),a=null)})()},void(a.print=function(){var a=window.open("","_blank","width=300,height=300");a.document.open(),a.document.write('<html><head><link rel="stylesheet" type="text/css" href="style.css" /></head><body onload="window.print()"><div ng-include="components/directives/order/order-services/order-installation-form.html"></div></body></html>'),a.document.close()})):void b.text("Missing order on the scope")}}}]),angular.module("theBossApp").directive("orderStatus",["$rootScope","theBossSettings",function(a,b){return{template:'<span class="label"></span>',restrict:"E",link:function(c,d){a.$on(b.orderChangedEvent,function(a,b){var d=b.status||"new";c.setLabelClass(d),console.log("orderStatus changed event",d)}),c.setLabelClass=function(a){var c=d.find("span");c.text(a),a.toLowerCase()===b.taskStatuses.Finished?c.attr("class","label label-success"):a.toLowerCase()===b.taskStatuses.InProgress?c.attr("class","label label-primary"):a.toLowerCase()===b.taskStatuses.Blocked?c.attr("class","label label-danger"):a.toLowerCase()===b.taskStatuses.New?c.attr("class","label label-warning"):c.attr("class","label label-default")},c.order&&c.setLabelClass(c.order.status),c.item&&c.setLabelClass(c.item.status)}}}]),angular.module("theBossApp").directive("orderTasks",["$rootScope","theBossSettings",function(a,b){return{template:'<work-log order="order"></work-log>',restrict:"E",controller:["$scope",function(c){a.$on(b.previewModeEvent,function(a,b){c.preview=b}),c.order_task_fields=[{title:"Title",type:"text",require:!0},{title:"Duration",type:"text",require:!0},{title:"Status Options",type:"textarea",require:!0}]}],link:function(c,d,e){c.order||d.text("Missing order on the scope"),a.$on(b.previewModeEvent,function(a,b){c.preview=b})}}}]),angular.module("theBossApp").directive("orderWorkflow",["ModalService","$rootScope","toaster","theBossSettings",function(a,b,c,d){return{template:'<div class="btn-group btn-group-justified">        <div class="btn-group" ng-show="showWorkflowAction(\'approved\')">            <button type="button" class="btn btn-success" ng-click="setStatus(\'approved\')">Approve</button>        </div>        <div class="btn-group" ng-show="showWorkflowAction(\'blocked\')">            <button type="button" class="btn btn-warning" ng-click="setStatus(\'blocked\')">Blocked</button>        </div>        <div class="btn-group" ng-show="showWorkflowAction(\'finished\')">            <button type="button" class="btn btn-success" ng-click="setStatus(\'finished\')">Finished</button>            </div>        </div>',restrict:"E",scope:{order:"="},link:function(e,f,g){return e.order?(e.showWorkflowAction=function(a){switch(e.order.status?e.order.status.toLowerCase():""){case"approved":case"in progress":return"blocked"===a||"finished"===a;case"blocked":return"approved"===a||"finished"===a;case"finished":return!1;default:return"approved"===a}return!1},void(e.setStatus=function(f){a.confirm.question("You are about to "+f+" this order, are you sure?",function(a){a&&e.order.$setStatus({status:f},function(a){b.$broadcast(d.orderChangedEvent,a),c.pop("success","Success","Updated status to "+f)},function(a){c.pop("error","Error","Error updating status "+a)})})()})):void f.text("orderWorkflow - Missing order on the scope")}}}]),angular.module("theBossApp").directive("restrictedAccess",["Auth","roles",function(a,b){return{restrict:"A",link:function(c,d,e){e.restrictedAccess?b.validateCurrentUserRoleIn(e.restrictedAccess)||d.remove():b&&!b.validateRoleAdmin(a.getCurrentUser())&&d.remove()}}}]),angular.module("theBossApp").directive("roleAccess",["roles",function(a){return{template:"<div></div>",restrict:"A",link:function(a,b,c){}}}]),angular.module("theBossApp").directive("services",["OrderService",function(a){return{templateUrl:"components/directives/services/services.html",restrict:"EA",scope:!0,link:function(b,c,d){b.totalOrders=0,b.orders=[],a.newAndNotCompletedServices().$promise.then(function(a){b.orders=a,b.totalOrders=a.length})}}}]),angular.module("theBossApp").directive("shippingList",["OrderService","$timeout","toaster",function(a,b,c){return{restrict:"E",templateUrl:"components/directives/shippingList/shippingList.html",scope:!0,controller:["$scope",function(b){b.orders=[],b.totalOrders=0,b.currentPage=1,b.maxSize=10,b.shipped_date=null,b.loadOrders=function(){var c={};c.limit=b.maxSize=10,c.page=b.currentPage,a.shippingList(c).$promise.then(function(a){b.orders=a.orders,b.currentPage=a.page,b.totalOrders=a.totalOrders})},b.order?b.orders=[b.order]:b.loadOrders(),b.$watch("currentPage",function(a,c){a!=c&&b.loadOrders()})}]}}]).directive("shippingListItem",["OrderService","$timeout","toaster","ModalService","moment","theBossSettings",function(a,b,c,d,e,f){return{restrict:"E",templateUrl:"components/directives/shippingList/shippingListItem.html",scope:{item:"="},link:function(g,h,i){g.opened=!1,g.today=function(){g.dt=new Date},g.today(),g.clear=function(){g.dt=null},g.toggleMin=function(){g.minDate=g.minDate?null:new Date},g.toggleMin(),g.open=function(a){a.preventDefault(),a.stopPropagation(),g.opened=!0},g.dateOptions={formatYear:"yy",startingDay:1},g.formats=["dd-MMMM-yyyy","yyyy/MM/dd","dd.MM.yyyy","shortDate"],g.format=g.formats[0];var j=null;g.$watch("item.shipped_date",function(h,i){h!=i&&(j?(b.cancel(j),j=null):d.confirm.question("Confirm shipping date of "+e(h).zone(f.timeZone).format("YYYY-MM-DD")+" set to order "+g.item.po_number,function(d){d&&(j=b(function(){var b=new a(g.item);b.$save(function(a){g.item.shipped=!0,c.pop("success","Success","Shipped date was updated")},function(a){c.pop("error","Error","Error saving you order "+a)})},1e3))})())})}}}]),angular.module("theBossApp").directive("workLog",["OrderService","$location","Auth","$sce","$filter","$rootScope","theBossSettings",function(a,b,c,d,e,f,g){return{templateUrl:"components/directives/work-log/work-log.html",restrict:"EA",scope:!0,link:function(h){h.totalOrders=0,h.currentPage=1,h.maxSize=10,h.loadTasks=function(){var b={};b.limit=h.maxSize=10,b.page=h.currentPage,a.tasks(b).$promise.then(function(a){h.orders=a.orders,h.currentPage=a.page,h.totalOrders=a.totalOrders})},h.order?h.orders=[h.order]:h.loadTasks();h.setTaskStatus=function(b,d,e,i,j,k,l){return l&&(l.preventDefault(),l.stopPropagation()),j.changed_by=c.getCurrentUser()._id,j.changed_on=new Date,j.status=k,b=new a(b),b.$save(function(a){b=a,f.$broadcast(g.orderChangedEvent,b),"finished"===a.status?h.orders.splice(d,1):b.forms[i].active=!0})},h.deleteTaskStatus=function(b,c,d,e,h,i){return i&&(i.preventDefault(),i.stopPropagation()),delete h.changed_by,delete h.changed_on,delete h.status,b=new a(b),b.$save(function(a){b=a,f.$broadcast(g.orderChangedEvent,b),b.forms[e].active=!0})},h.loadOrder=function(a){b.path("/order/"+a)},h.getOrderTitle=function(a){if(a&&a.customer){var b=e("date")(a.date_required);return d.trustAsHtml(a.customer.name+" - "+a.po_number+" @ "+b)}return""},h.$watch("currentPage",function(a,b){a!=b&&h.loadTasks()})}}}]),angular.module("theBossApp").filter("encodeUrl",function(){return window.encodeURIComponent}),angular.module("theBossApp").filter("thebossDate",function(){return function(a){return a?(a=new Date(a),new Date(a.getUTCFullYear(),a.getUTCMonth(),a.getUTCDate(),a.getUTCHours(),a.getUTCMinutes(),a.getUTCSeconds()).toLocaleDateString()):""}}),angular.module("theBossApp").service("FormService",["$resource",function(a){return a("/api/forms/:id",{id:"@_id"},{get:{method:"GET",isArray:!0,url:"/api/forms/:module",params:{module:"@module"}},addField:{method:"PUT",url:"/api/forms/:id/fields",params:{id:"@id"}},deleteField:{method:"DELETE",url:"/api/forms/:id/field/:fieldId",params:{id:"@_id",fieldId:"@fieldId"}},updateField:{method:"PUT",url:"/api/forms/:id/fields/:fieldId",params:{id:"@_id",fieldId:"@fieldId"}},addOrUpdate:{method:"PUT",url:"/api/forms/:id/:target/:targetId",params:{id:"@id",targetId:"@targetId",target:"@target"}},addFieldOption:{method:"PUT",url:"/api/forms/:module/:field/:option",params:{module:"@module",field:"@field",option:"@option"}},"delete":{method:"DELETE",url:"/api/forms/:id",params:{id:"@_id"}}})}]),angular.module("theBossApp").factory("ModalService",["$rootScope","$modal",function(a,b){function c(c,d){var e=a.$new();return c=c||{},d=d||"modal-default",angular.extend(e,c),b.open({templateUrl:"components/modal/modal.html",controller:"ModalInstanceCtrl",resolve:{fields:function(){return c.fields}},windowClass:d,scope:e})}function d(a){var b={};return angular.forEach(a,function(a){var c=a.name||a.title,d=a.value,f=c.toLowerCase().replace(" ","_").split(".");e(b,f,d),a.value=null}),b}function e(a,b,c){for(var d=0,e=b.length-1;e>d;d++)a[b[d]]||(a[b[d]]={}),a=a[b[d]];a[b[d]]=c}return{confirm:{"delete":function(a){return a=a||angular.noop,function(){var b,d=Array.prototype.slice.call(arguments),e=d.shift();b=c({modal:{dismissable:!0,title:"Confirm Delete",html:"<p>Are you sure you want to delete <strong>"+e+"</strong> ?</p>",buttons:[{classes:"btn-danger",text:"Delete",click:function(a){b.close(a)}},{classes:"btn-default",text:"Cancel",click:function(a){b.dismiss(a)}}]}},"modal-danger"),b.result.then(function(b){a.apply(b,d)})}},question:function(a,b){return b=b||angular.noop,function(){var d,e=(Array.prototype.slice.call(arguments),!1);d=c({modal:{dismissable:!0,title:"Confirm",html:"<p><strong>"+a+"</strong></p>",buttons:[{classes:"btn-success",text:"Yes",click:function(a){e=!0,d.close(a)}},{classes:"btn-default",text:"No",click:function(a){d.close(a)}}]}}),d.result.then(function(a){b(e)})}}},show:{showPopup:function(a,b,d){return d=d||angular.noop,function(){var e=c({modal:{title:a,html:b,buttons:[{classes:"btn-default",text:"Close",click:function(a){e.dismiss(a)}}]}},"modal");e.result.then(function(){(d||angular.noop)()})}},showOrderDetailsPopup:function(a,c,d){return d=d||angular.noop,function(){var e=b.open({size:"lg",template:'<div class="modal-header"> <h5>'+a+'</h5> </div><div class="modal-body"><form class="form-horizontal"><order-preview order="order"></order-preview> </form> </div> <div class="modal-footer"> <button class="btn btn-warning" ng-click="close()" id="close">Close</button> </div>',resolve:{order:function(){return c}},controller:["$scope","$modalInstance","order",function(a,b,c){a.order=c,a.preview=!0,a.close=function(){b.close()}}]});e.result.then(function(){(d||angular.noop)()})}},modalFormDialog:function(a,b,e){return e=e||angular.noop,function(){var f=c({fields:b,modal:{title:a,form:!0}},"modal");f.result.then(function(a){a&&e(d(a))})}}}}}]).controller("ModalInstanceCtrl",["$scope","$modalInstance","fields",function(a,b,c){a.fields=c,a.ok=function(){b.close(a.fields)},a.cancel=function(){b.dismiss("cancel")}}]),angular.module("theBossApp").directive("mongooseError",function(){return{restrict:"A",require:"ngModel",link:function(a,b,c,d){b.on("keydown",function(){return d.$setValidity("mongoose",!0)})}}}),angular.module("theBossApp").controller("NavbarCtrl",["$scope","$location","Auth",function(a,b,c){a.menu=[{title:"Home",link:"/"},{title:"Orders",link:"/order/list"},{title:"Calendar",link:"/calendar"},{title:"Services",link:"/order/services"},{title:"Add Order",link:"/order/detail"}],a.isCollapsed=!0,a.isLoggedIn=c.isLoggedIn,a.isAdmin=c.isAdmin,a.getCurrentUser=c.getCurrentUser,a.status={isopen:!1},a.logout=function(){c.logout(),b.path("/login")},a.isActive=function(a){return a===b.path()}}]),angular.module("theBossApp").service("Note",["$resource",function(a){return a("/api/notes/:id",{id:"@_id"},{New:{url:"/api/notes",method:"GET",isArray:!0,params:{resolved:!1}},OrderNotes:{url:"/api/notes",method:"GET",isArray:!0}})}]),angular.module("theBossApp").service("OrderService",["$resource",function(a){return a("/api/orders/:orderId",{orderId:"@_id"},{query:{method:"GET",isArray:!1},services:{url:"/api/orders/services",isArray:!1,method:"GET"},download:{url:"/api/orders/download/:filename",params:{filename:"@filename"},isArray:!1,method:"GET"},newAndNotCompletedServices:{url:"/api/orders/newAndNotCompletedServices",isArray:!0,method:"GET"},tasks:{url:"/api/orders/todotasks",method:"GET"},shippingList:{url:"/api/orders/shippingList",method:"GET",isArray:!1},accessories:{url:"/api/orders/accessories",method:"GET",isArray:!1,params:{status:"@status"}},comments:{url:"/api/orders/comments",method:"GET",isArray:!0},getOrders:{url:"/api/orders/calendar/:from/:to/orders/:status",params:{status:"@status",from:"@from",to:"@to"},isArray:!0,method:"GET"},getOrderServices:{url:"/api/orders/calendar/:from/:to/services/:approved/:completed",params:{approved:"@approved",completed:"@completed",from:"@from",to:"@to"},isArray:!0,method:"GET"},setStatus:{url:"/api/orders/:orderId/status/:status",params:{orderId:"@_id",status:"@status"},method:"PATCH"},setdate_required:{url:"/api/orders/:orderId/calendar_update_date/:property/:date",params:{orderId:"@orderId",property:"@property",date:"@date"},method:"PATCH"}})}]),angular.module("theBossApp").service("roles",["$rootScope","Auth",function(a,b){var c=["admin"],d=["sales rep"],e=["user","worker"];return{validateRoleAdmin:function(b){return b=b||a.currentUser,b?_.contains(c,b.role):!1},validateServiceApproval:function(b){return b=b||a.currentUser,b?_.contains(c,b.role)||_.contains(d,b.role):!1},validateRoleOther:function(b){return b=b||a.currentUser,b?_.contains(e,b.role):!1},validateCurrentUserRoleIn:function(a){return a=a.split(","),_.contains(a,b.getCurrentUser().role)}}}]),angular.module("theBossApp").factory("socket",["socketFactory",function(a){var b=io("",{path:"/socket.io-client"}),c=a({ioSocket:b});return{socket:c,syncUpdates:function(a,b,d){d=d||angular.noop,c.on(a+":save",function(a){var c=_.find(b,{_id:a._id}),e=b.indexOf(c),f="created";c?(b.splice(e,1,a),f="updated"):b.push(a),d(f,a,b)}),c.on(a+":remove",function(a){var c="deleted";_.remove(b,{_id:a._id}),d(c,a,b)})},unsyncUpdates:function(a){c.removeAllListeners(a+":save"),c.removeAllListeners(a+":remove")}}}]),angular.module("theBossApp").service("timeOff",["$resource",function(a){return a("/api/timeoffs/:id",{id:"@_id"},{getTimeOff:{url:"/api/timeoffs/query/:approved/:dateFrom/:dateTo",params:{approved:"@approved",from:"@dateFrom",to:"@dateTo"},isArray:!0,method:"GET"},check:{url:"/api/timeoffs/check",isArray:!0,method:"GET"},"new":{url:"/api/timeoffs/totalNewTimeoffs",isArray:!1,method:"GET"}})}]),angular.module("theBossApp").filter("timeago",function(){return function(a,b){var c,d=function(a,b,c){var d=$.isFunction(a)?a(b,i):a,e=c.numbers&&c.numbers[b]||b;return d.replace(/%d/i,e)},e=(new Date).getTime(),f=new Date(a).getTime(),g=b||!1,h={prefixAgo:null,prefixFromNow:null,suffixAgo:"ago",suffixFromNow:"from now",seconds:"less than a minute",minute:"about a minute",minutes:"%d minutes",hour:"about an hour",hours:"about %d hours",day:"a day",days:"%d days",month:"about a month",months:"%d months",year:"about a year",years:"%d years"},i=e-f,j=Math.abs(i)/1e3,k=j/60,l=k/60,m=l/24,n=m/365,o=void 0===h.wordSeparator?" ":h.wordSeparator,p=h.prefixAgo,q=h.suffixAgo;return g&&0>i&&(p=h.prefixFromNow,q=h.suffixFromNow),c=45>j&&d(h.seconds,Math.round(j),h)||90>j&&d(h.minute,1,h)||45>k&&d(h.minutes,Math.round(k),h)||90>k&&d(h.hour,1,h)||24>l&&d(h.hours,Math.round(l),h)||42>l&&d(h.day,1,h)||30>m&&d(h.days,Math.round(m),h)||45>m&&d(h.month,1,h)||365>m&&d(h.months,Math.round(m/30),h)||1.5>n&&d(h.year,1,h)||d(h.years,Math.round(n),h),a?$.trim([p,c,q].join(o)):""}}),angular.module("theBossApp").run(["$templateCache",function(a){a.put("app/account/login/login.html",'<div ng-include="\'components/navbar/navbar.html\'"></div><div class=container><div class=row><div class="col-md-3 col-md-offset-4"><div class="login-panel panel panel-default"><div class=panel-heading><h3 class=panel-title>Please Sign In</h3></div><div class=panel-body><form role=form name=form ng-submit=login(form) novalidate><fieldset><div class=form-group ng-class="{ \'has-error\' : form.email.$invalid && !form.email.$pristine }"><input type=email placeholder=E-mail name=email class=form-control ng-model=user.email ng-required=true><p ng-show="form.email.$invalid && !form.email.$pristine" class=help-block>Enter a valid email.</p></div><div class=form-group ng-class="{ \'has-error\' : form.password.$invalid && !form.password.$pristine }"><input type=password placeholder=Password name=password class=form-control ng-model=user.password ng-required=true><p ng-show="form.password.$invalid && !form.password.$pristine" class=help-block>Enter password.</p></div><div class=checkbox><label><input type=checkbox name=remember data-ng-click=rememberMe() data-ng-model="remember"> Remember Me</label></div><div class=form-group ng-class="{ \'has-error\' :  errors.other}"><p class=help-block>{{ errors.other }}</p></div><!-- Change this to a button or input when using this as a form --><button type=submit class="btn btn-lg btn-success btn-block" ng-disabled=form.$invalid>Sign in</button></fieldset></form></div></div></div></div></div>'),a.put("app/account/settings/settings.html",'<div ng-include="\'components/navbar/navbar.html\'"></div><div class=container><h1>Settings</h1><div class=row><div class=col-sm-4><div class="panel panel-default"><div class=panel-heading>Change Password</div><div class=panel-body><form class=form name=form ng-submit=changePassword(form) novalidate><div class=form-group><label>Current Password</label><input type=password name=password class=form-control ng-model=user.oldPassword mongoose-error><p class=help-block ng-show=form.password.$error.mongoose>{{ errors.other }}</p></div><div class=form-group><label>New Password</label><input type=password name=newPassword class=form-control ng-model=user.newPassword ng-minlength=3 required><p class=help-block ng-show="(form.newPassword.$error.minlength || form.newPassword.$error.required) && (form.newPassword.$dirty || submitted)">Password must be at least 3 characters.</p></div><p class=help-block>{{ message }}</p><button class="btn btn-lg btn-primary" type=submit>Save changes</button></form></div></div></div><div class=col-sm-8><div class="panel panel-default"><div class=panel-heading>Add Time off</div><div class=panel-body><form class=form name=formTimeoff ng-submit=addNewRequest(formTimeoff)><div field ng-model=timeoff.detail ng-field="{title:\'Detail\', type:\'textarea\', require: true}"></div><div field ng-model=timeoff.type ng-field="{title:\'Type\', type:\'select\', require: true, show_options: \'Vacation,Sick,Day off,Statutory holiday\'}"></div><div field ng-model=timeoff.from ng-field="{title:\'From\', type:\'date\', require:true, show_options: [{showMinToday:true}]}"></div><div field ng-model=timeoff.to ng-field="{title:\'To\', type:\'date\', require:true, show_options: [{showMinToday:true}]}"></div><div class=form-group><div class="col-sm-offset-4 col-sm-10"><button type=submit class="btn btn-success">Add</button></div></div></form></div></div><table class="table table-striped"><tr><th>#</th><th>Detail</th><th>Type</th><th>Date From</th><th>Date To</th><th>Created By</th><th restricted-access>Approved</th><th></th></tr><tr ng-repeat="timeoff in timeoffs" ng-class="{\'success\': timeoff.approved}"><td>{{$index + 1}}</td><td>{{timeoff.detail}}</td><td>{{timeoff.type}}</td><td>{{timeoff.from | date}}</td><td>{{timeoff.to | date}}</td><td>{{timeoff.createdBy.name}}</td><td restricted-access><label><input type=checkbox ng-model=timeoff.approved ng-click=approveToggle($index,timeoff)></label></td><td><button class="btn btn-danger btn-xs" ng-click=delete($index,timeoff)><span class="glyphicon glyphicon-trash"></span></button></td></tr></table></div></div></div>'),a.put("app/account/signup/signup.html",'<div ng-include="\'components/navbar/navbar.html\'"></div><div class=container><div class=row><div ng-include="\'app/account/user/user.menu.html\'"></div><div class=col-md-10><div class="panel panel-default"><div class=panel-heading><h3 class=panel-title>Create new user</h3></div><div class=panel-body><form role=form name=form class=inline ng-submit=register(form) novalidate><fieldset><div class=form-group ng-class="{ \'has-error\' : form.name.$invalid && !form.name.$pristine }"><input placeholder=Name name=email class=form-control ng-model=user.name ng-required=true><p ng-show="form.name.$invalid && !form.name.$pristine" class=help-block>Enter a valid name.</p></div><div class=form-group ng-class="{ \'has-error\' : form.email.$invalid && !form.email.$pristine }"><input type=email placeholder=E-mail name=email class=form-control ng-model=user.email ng-required=true><p ng-show="form.email.$invalid && !form.email.$pristine" class=help-block>Enter a valid email.</p></div><div class=form-group ng-class="{ \'has-error\' : form.password.$invalid && !form.password.$pristine }"><input type=password placeholder=Password name=password class=form-control ng-model=user.password ng-minlength=3 required mongoose-error><p class=help-block ng-show="(form.password.$error.minlength || form.password.$error.required)">Password must be at least 3 characters.</p><p class=help-block ng-show=form.password.$error.mongoose>{{ errors.password }}</p></div><div class=form-group><div class="btn-group col-sm-4"><label>Role</label></div><div class="btn-group col-sm-8"><label class="btn btn-primary" ng-model=user.role btn-radio="\'admin\'">Admin</label><label class="btn btn-primary" ng-model=user.role btn-radio="\'service rep\'">Service Rep</label><label class="btn btn-primary" ng-model=user.role btn-radio="\'user\'">Sale Rep</label><label class="btn btn-primary" ng-model=user.role btn-radio="\'worker\'">Worker</label></div></div><div class=form-group ng-class="{ \'has-error\' :  errors.other}"><p class=help-block>{{ errors.other }}</p></div><br><!-- Change this to a button or input when using this as a form --><button type=submit class="btn btn-success btn-block" ng-disabled=form.$invalid>Submit</button></fieldset></form></div></div></div></div><!-- \n        <hr>\n        <div>\n          <a class="btn btn-facebook" href="" ng-click="loginOauth(\'facebook\')">\n            <i class="fa fa-facebook"></i> Connect with Facebook\n          </a>\n          <a class="btn btn-google-plus" href="" ng-click="loginOauth(\'google\')">\n            <i class="fa fa-google-plus"></i> Connect with Google+\n          </a>\n        </div> --></div>'),
a.put("app/account/user/user.html",'<div ng-include="\'components/navbar/navbar.html\'"></div><div class=container><div class=row><div ng-include="\'app/account/user/user.menu.html\'"></div><div class=col-md-10><div class="panel panel-default"><div class=panel-heading>User search</div><div class=panel-body><div class=well><form ng-submit=loadUsers()><div class=input-group><input class=form-control ng-model=queryText placeholder=Search></div><!-- /input-group --></form></div><div class=row><div class=col-md-12><div class=table-responsive><table class="table table-hover table-condensed"><thead><tr><th>Name</th><th>Email</th><th>Role</th><th></th></tr></thead><tbody><tr ng-repeat="user in users"><td>{{ user.name }}</td><td>{{ user.email }}</td><td><div class=btn-group><label class="btn btn-primary" ng-model=user.role btn-radio="\'admin\'" ng-click="changRole(user,\'admin\')">Admin</label><label class="btn btn-primary" ng-model=user.role btn-radio="\'service rep\'" ng-click="changRole(user,\'service rep\')">Service Rep</label><label class="btn btn-primary" ng-model=user.role btn-radio="\'user\'" ng-click="changRole(user,\'user\')">Sales Rep</label><label class="btn btn-primary" ng-model=user.role btn-radio="\'worker\'" ng-click="changRole(user,\'worker\')">Worker</label></div></td><td><button type=button class="btn btn-danger" ng-click=delete(user,$index)>Delete</button></td></tr></tbody></table></div></div></div></div></div></div></div></div>'),a.put("app/account/user/user.menu.html",'<div class=col-md-2><div class="panel panel-default"><div class=panel-heading>Filters</div><div class=panel-body><p>Select users filter</p><a class="btn btn-primary btn-lg" href=/signup>New User</a></div><ul class=list-group><a href=/user/admin class=list-group-item active-url>Administrators</a> <a href="/user/service rep" class=list-group-item active-url>Service Reps</a> <a href=/user/user class=list-group-item active-url>Sales Reps</a> <a href=/user/worker class=list-group-item active-url>Workers</a> <a href=/user class=list-group-item active-url>All</a></ul></div></div>'),a.put("app/admin/admin.html",'<div ng-include="\'components/navbar/navbar.html\'"></div><div class=container><p>The delete user and user index api routes are restricted to users with the \'admin\' role.</p><ul class=list-group><li class=list-group-item ng-repeat="user in users"><strong>{{user.name}}</strong><br><span class=text-muted>{{user.email}}</span> <a ng-click=delete(user) class=trash><span class="glyphicon glyphicon-trash pull-right"></span></a></li></ul></div>'),a.put("app/calendar/calendar-services.html","<div ui-calendar=uiConfig.calendar calendar=myCalendar ng-model=eventSources></div>"),a.put("app/calendar/calendar-status.html","<div ui-calendar=uiConfig.calendar calendar=myCalendar ng-model=eventSources></div>"),a.put("app/calendar/calendar.html",'<div ng-include="\'components/navbar/navbar.html\'"></div><div class=container><div class=row><div class=col-md-10><div ui-view><div ui-calendar=uiConfig.calendar calendar=myCalendar ng-model=eventSources></div></div></div><div class=col-md-2><div class="panel panel-default"><div class=panel-heading>Jobs</div><div class=panel-body><ul class=list-group><a ng-href=/calendar/jobs/new class=list-group-item active-url>New, pending approval</a> <a href=/calendar/jobs/approved class=list-group-item active-url>Approved</a> <a href=/calendar/jobs/finished class=list-group-item active-url>Completed</a> <a href=/calendar/jobs class=list-group-item active-url>All</a></ul></div><div class=panel-footer><form ng-submit=loadOrders()><div class=input-group><input class=form-control ng-model=queryText> <span class=input-group-btn><button class="btn btn-default" type=submit>Search</button></span></div><!-- /input-group --></form></div></div><div class="panel panel-danger"><div class=panel-heading>Services</div><div class=panel-body><ul class=list-group><a href=/calendar/service/false/false class=list-group-item active-url>New, pending approval</a> <a href=/calendar/service/true/false class=list-group-item active-url>Approved</a> <a href=/calendar/service/true/false class=list-group-item active-url>Not Completed</a> <a href=/calendar/service/true/true class=list-group-item active-url>Completed</a> <a href=/calendar/service class=list-group-item active-url>All</a></ul></div></div><div class="panel panel-default"><div class=panel-heading>Legend</div><div class=panel-body><span class="label label-warning">New Unapproved Orders</span> <span class="label label-default">Approved</span> <span class="label label-primary">In Progress</span> <span class="label label-success">Finished Orders</span> <span class="label label-danger">Service/Blocked</span> <span class="label label-dark">New Installation Date</span> <span class="label label-bright">Shipped</span> <span class="label label-timeoff">Time Off</span></div></div></div></div></div>'),a.put("app/form/form.html","<div class=col-md-12>This is the form view.</div>"),a.put("app/main/main.html",'<div ng-include="\'components/navbar/navbar.html\'"></div><div class=container><div restrict-access="admin, user"><div class=row><div class="col-lg-6 col-md-6"><work-log></work-log><shipping-list></shipping-list></div><div class="col-lg-6 col-md-6"><new-orders></new-orders><services></services><notes></notes><accessories></accessories></div></div></div></div><footer class=footer><div class=container><p>Angular Fullstack v2.0.13 | <a href=https://twitter.com/tyhenkel>@tyhenkel</a> | <a href="https://github.com/DaftMonk/generator-angular-fullstack/issues?state=open">Issues</a></p></div></footer>'),a.put("app/order/order-detail/order-detail.html",'<div class=col-md-12><h2>{{getOrderName()}}</h2><form name=form class=form-horizontal role=form novalidate ng-submit=save(form) ng-class={submitted:submitted}><div class=row><div class=col-md-4><div class="panel panel-default"><div class=panel-body><ul class=list-group><li class="list-group-item list-group-item-info"><span class=pull-right><order-status></order-status></span> Status:</li><li class="list-group-item list-group-item-info"><span class=pull-right>{{ order.createdBy.name }} on {{ order.created_on | date }}</span> Created by:</li><li class="list-group-item list-group-item-info"><span class=pull-right>{{ order.last_updated_by.name }} on {{ order.last_updated_on | date }}</span> Last updated by:</li><li class="list-group-item list-group-item-info"><span class=pull-right>{{ order.date_required | date }}</span> Required Date</li><li class="list-group-item list-group-item-info" ng-if=order._id><div class=row><div class=col-md-4>Installation Date</div><div class=col-md-8><p class=input-group><input class=form-control datepicker-popup={{format}} ng-model=order.installation_date is-open=opened min-date=minDate data-show-weeks=false data-show-today=false datepicker-options=dateOptions date-disabled="disabled(date, mode)" ng-required=true close-text="Close"> <span class=input-group-btn><button type=button class="btn btn-default" ng-click=open($event)><i class="glyphicon glyphicon-calendar"></i></button></span></p></div></div></li><li ng-if=order.installation_by.name class="list-group-item list-group-item-info"><span class=pull-right>{{ order.installation_by.name }}</span> <strong>Installed By</strong></li><li class="list-group-item list-group-item-info" ng-if=order._id><div field ng-model=order.installation_by ng-field="{title:\'Installed&nbsp;by\', type:\'user\'}"></div></li></ul><order-workflow order=order restricted-access ng-if=!isNewOrder()></order-workflow><div class="btn-group btn-group-justified" restricted-access ng-if=!isNewOrder()><div class=btn-group><button type=button class="btn btn-default" ng-click=edit()>Edit</button></div><div class=btn-group><button type=button class="btn btn-danger" ng-click=delete()>Delete</button></div></div></div></div></div><div class=col-md-8><tabset justified=true ng-if=!preview><tab><tab-heading>Order&nbsp;<span class=badge ng-show=order.total_working_hours>{{ order.total_working_hours }} working hours</span></tab-heading><div class=well><order-details order=order></order-details></div></tab><tab heading=Tasks disabled><div class=well><p>Add list of tasks that needs to be done to finish the order.</p><order-tasks></order-tasks></div></tab><tab active=actives.two heading=Accessories><div class=well><p>Add list of accessories that was ordered from the manufacturers and needs to be received.</p><order-accessories></order-accessories></div></tab><tab heading=Services disabled><div class=well><p>Add list of services associated with this order.</p><div class="panel panel-default"><div class=panel-heading>Services<div class=pull-right><div class=btn-group><button type=button class="btn btn-default btn-xs" id=add ng-click=addNewService(order)>Add new service</button></div></div></div><div class=panel-body><div class=list-group><div class=list-group-item class=list-group-item-success><div><h4 class=list-group-item-heading>{{order.po_number}} - Installation <a ng-href=/order/detail/{{order._id}}/print/Installation><span class="glyphicon glyphicon-print"></span></a></h4><p class=list-group-item-text>{{ order.installation_date | date }}</p></div></div><order-services></order-services></div></div></div></div></tab><tab heading=Files disabled><div class=well><p>Add list of files associated with this order.</p><file-uploads model=order upload-url="/api/orders/{{ order._id }}/upload"></file-uploads></div></tab></tabset><order-preview order=order ng-if=preview></order-preview></div></div><div class=well ng-if=!preview><button type=submit class="btn btn-default">Save</button> <button type=reset class="btn btn-default" ng-click=reset()>Reset</button></div><ul><li ng-repeat="frmData in form.$formData()"></li></ul></form></div>'),a.put("app/order/order-list/order-list.html",'<div class=row><div class=col-md-2><div class="panel panel-default"><div class=panel-heading>Filters</div><div class=panel-body><p>Select your orders by quick search by status or advanced search by additional order properties</p><a class="btn btn-primary btn-lg" ui-sref=order.new>New Order</a></div><ul class=list-group><a href=/order/list/new class=list-group-item active-url>New, pending approval</a> <a href=/order/list/approved class=list-group-item active-url>Approved</a> <a href=/order/list/finished class=list-group-item active-url>Completed</a> <a href=/order/list class=list-group-item active-url>All</a></ul></div></div><div class=col-md-10><div class="panel panel-default"><div class=panel-heading>Order search</div><div class=panel-body><div class=well><form ng-submit=loadOrders()><div class=row><div class=col-lg-6><div class=input-group><input class=form-control ng-model=queryText placeholder="Search order..."> <span class=input-group-btn><button class="btn btn-default" type=button ng-click=loadOrders()>Search</button></span></div><!-- /input-group --></div><!-- /.col-lg-6 --></div></form></div><div class=row><div class=col-md-12><div class=table-responsive><table class="table table-hover table-condensed"><thead><tr><th>#</th><th>Customer</th><th>Date Required</th><th>Shipped Date</th><th>Status</th><th>Created By</th><th>Created On</th></tr></thead><tbody><tr ng-repeat="order in orders"><td><a href="/order/detail/{{ order._id }}/" tooltip=asdasd>{{ order.po_number }}</a></td><td><a href="/order/detail/{{ order._id }}/">{{ order.customer.name }}</a></td><td>{{ order.date_required | date }} <span class="label label-default pull-right" ng-show=order.installation_date>{{ order.installation_date | date }}</span></td><td>{{ order.shipped_date | date }}</td><td><order-status></order-status></td><td>{{ order.createdBy.name }}</td><td>{{ order.created_on | date }}</td></tr></tbody></table><pagination ng-model=currentPage total-items=totalOrders page=currentPage max-size=maxSize class=pagination-sm boundary-links=true rotate=false num-pages=numPages></pagination><pre>Page: {{currentPage}} / {{numPages}}</pre></div></div></div></div></div></div></div>'),a.put("app/order/order-print/order-print.html",'<div class=row><div class=col-xs-4><img ng-src=assets/images/e00cc779.logo.png height=100px></div><div class=col-xs-4><h4><strong>{{action}} Form</strong></h4></div><div class=col-xs-4><span class=pull-right>766 York Road<br>N.O.T.L, ON L0S 1J0<br>Phone: 905-685-6567<br>Fax: 905-685-0585</span></div></div><br><div class=row><div class=col-xs-6><strong>Customer Name:</strong>&nbsp;{{order.customer.name}}</div><div class=col-xs-6>{{ getFormDate()}} - PO# {{order.po_number}}</div></div><div class=row><div class=col-xs-12><p>Address: {{order.customer.ship_to}}</p><p ng-if=order.customer.phone>Contact Number: {{order.customer.phone}}</p><p ng-if=order.customer.cell>Secondary Number: {{order.customer.cell}}</p></div></div><div class=row><div class=col-xs-12><strong>Day 1:</strong></div></div><div class=row><div class=col-xs-6>Arrival Time: ___________________</div><div class=col-xs-6>Time of Completion: ___________________</div></div><div class=row><div class=col-xs-12><strong>Day 2:</strong></div></div><div class=row><div class=col-xs-6>Arrival Time: ___________________</div><div class=col-xs-6>Time of Completion: ___________________</div></div><div class=row><div class=col-xs-12><strong>Day 3:</strong></div></div><div class=row><div class=col-xs-6>Arrival Time: ___________________</div><div class=col-xs-6>Time of Completion: ___________________</div></div><br><br><div class=row><div class=col-xs-12><strong>Deficiency List:</strong></div><div class="col-xs-12 filldetails">{{details}}</div></div><div class=row><div class=col-xs-12>Please sign in agreement of completion or deficiency list above:</div></div><div class=row><div class=col-xs-3><strong ng-if=done_by>Installer: {{done_by.name}}</strong> <strong ng-if=!done_by>Installer: ___________________</strong></div><div class=col-xs-3><strong>Date: ____________________</strong></div><div class=col-xs-3><strong>Customer: ____________________</strong></div><div class=col-xs-3><strong>Date: ____________________</strong></div></div><br><div class="row hidden-print"><div class=col-xs-12><button type=button class="btn btn-primary btn-lg btn-block" ng-click=print()>Print</button></div></div>'),a.put("app/order/order-services/order-services.html",'<div class=row><div class=col-md-2><div class="panel panel-default"><div class=panel-heading>Filters</div><ul class=list-group><a href=/order/services/pending class=list-group-item active-url>New, pending</a> <a href=/order/services/finished class=list-group-item active-url>Completed</a> <a href=/order/services class=list-group-item active-url>All</a></ul></div></div><div class=col-md-10><div class="panel panel-default"><div class=panel-heading>Order search</div><div class=panel-body><div class=well><form ng-submit=loadOrders()><div class=row><div class=col-lg-6><div class=input-group><input class=form-control ng-model=queryText placeholder="Search order..."> <span class=input-group-btn><button class="btn btn-default" type=button ng-click=loadOrders()>Search</button></span></div><!-- /input-group --></div><!-- /.col-lg-6 --></div></form></div><div class="panel panel-default"><div class=panel-heading>Services</div><div class=panel-body><div class=row><accordion><accordion-group heading={{getOrderName(order)}} ng-repeat="order in orders"><div class=well><order-services order=order></order-services></div></accordion-group></accordion><pagination ng-model=currentPage total-items=totalOrders page=currentPage max-size=maxSize class=pagination-sm boundary-links=true rotate=false num-pages=numPages></pagination><pre>Page: {{currentPage}} / {{numPages}}</pre></div></div></div></div></div></div></div>'),a.put("app/order/order.html",'<div ng-include="\'components/navbar/navbar.html\'"></div><div class=container><div ui-view=""></div></div>'),a.put("components/directives/accessories/accessories.html",'<div class="panel panel-default"><div class=panel-heading>Ordered Accessories</div><div class=panel-body><div class=pannel ng-repeat="item in orders"><h4>{{ item.customer.name }} - {{ item.po_number }}</h4><div class=table-responsive><table class="table table-striped table-bordered table-hover"><thead><tr class=active><th>From</th><th>Description</th><th>Items Ordered</th><th>Items Received</th></tr></thead><tbody><tr ng-repeat="accessory in item.ordered_accessories | filter:notreceived "><td>{{ accessory.from_manufacturer }}</td><td>{{ accessory.description }}</td><td>{{ accessory.quantity }}</td><td><div class=row><div class=col-md-6><div class="input-group input-group-sm"><input type=number class=form-control placeholder="Items received" ng-model=accessory.items_received></div></div><div class=col-md-6><button type=submit data-ng-click="saveUpdates($index, item, accessory)" class="btn btn-default">Update</button></div></div></td></tr></tbody></table></div></div><div class=panel-footer><pagination total-items=totalOrders ng-model=currentPage page=currentPage max-size=maxSize class=pagination-sm boundary-links=true rotate=false num-pages=numPages></pagination><pre>Page: {{currentPage}} / {{numPages}}</pre></div></div></div>'),a.put("components/directives/alerts/alerts.html",'<li class=dropdown><a class=dropdown-toggle data-toggle=dropdown href=# aria-expanded=false><i class="fa fa-bell fa-fw"></i><span class=badge>{{alerts.length}}</span> <i class="fa fa-caret-down"></i></a><ul class="dropdown-menu dropdown-alerts"><li ng-repeat="alert in alerts"><a ng-href={{alert.url}}><div><i class="fa {{alert.icon}} fa-fw"></i> {{alert.type}} <span class="pull-right text-muted small">{{alert.message}}</span></div></a></li></ul><!-- /.dropdown-alerts --></li>'),a.put("components/directives/field-upload/field-upload.html",'<div class=row ng-if=!preview><div class=form-group><label class="control-label col-sm-2">Select Files</label><div class=col-sm-8><input type=file ng-file-select=onFileSelect($files) multiple class=form-control></div></div><div class=form-group><label class="control-label col-sm-2"></label><div class=col-sm-8><div class=drop-box ng-file-drop=onFileSelect($files) ng-file-drag-over-class=optional-css-class ng-show=dropSupported>drop files here</div><div ng-file-drop-available="dropSupported=true" ng-show=!dropSupported>HTML5 Drop File is not supported!</div></div></div></div><div class=row><div class=col-sm-6 ng-if=!preview><div class="panel panel-default"><!-- Default panel contents --><div class=panel-heading><div ng-show="selectedFiles != null">Uploading files</div><div ng-show=!selectedFiles>No files selected</div></div><div class=panel-body><div class=row ng-repeat="f in selectedFiles"><div class=col-sm-6><progressbar value=progress[$index]><i>{{ f.name }}</i></progressbar></div><div class=col-sm-2><button ng-show="progress[$index] < 0" ng-click=start($index) class="button ng-hide">Start</button> <button ng-show="hasUploader($index) && progress[$index] < 100" ng-click=abort($index) class="button ng-hide">Abort</button></div></div><button ng-click=upload.abort() ng-show=hasUploadingInProgress() class=form-control>Cancel Upload</button></div></div></div><div ng-class="{\'col-sm-6\': !preview, \'col-sm-12\': preview}"><div class="panel panel-default"><!-- Default panel contents --><div class=panel-heading>Uploaded files</div><div class=panel-body><div class=list-group><div class=list-group-item ng-repeat="f in model.uploaded_files"><i class="fa fa-ban btn" ng-click=deleteFile(f,$index,$event)></i> <a href="/uploads/{{ encodeFileName(f.filename) }}" target=_blank>{{ f.filename }} <span class=badge>{{ f.size }} kb</span></a></div></div></div></div></div></div>'),a.put("components/directives/file-uploads/field-upload.html",'<div class=row ng-if=!preview><div class=form-group><label class="control-label col-sm-2">Select Files</label><div class=col-sm-8><input type=file ng-file-select=onFileSelect($files) multiple class=form-control></div></div><div class=form-group><label class="control-label col-sm-2"></label><div class=col-sm-8><div class=drop-box ng-file-drop=onFileSelect($files) ng-file-drag-over-class=optional-css-class ng-show=dropSupported>drop files here</div><div ng-file-drop-available="dropSupported=true" ng-show=!dropSupported>HTML5 Drop File is not supported!</div></div></div></div><div class=row><div class=col-sm-6 ng-if=!preview><div class="panel panel-default"><!-- Default panel contents --><div class=panel-heading><div ng-show="selectedFiles != null">Uploading files</div><div ng-show=!selectedFiles>No files selected</div></div><div class=panel-body><div class=row ng-repeat="f in selectedFiles"><div class=col-sm-6><progressbar value=progress[$index]><i>{{ f.name }}</i></progressbar></div><div class=col-sm-2><button ng-show="progress[$index] < 0" ng-click=start($index) class="button ng-hide">Start</button> <button ng-show="hasUploader($index) && progress[$index] < 100" ng-click=abort($index) class="button ng-hide">Abort</button></div></div><button ng-click=upload.abort() ng-show=hasUploadingInProgress() class=form-control>Cancel Upload</button></div></div></div><div ng-class="{\'col-sm-6\': !preview, \'col-sm-12\': preview}"><div class="panel panel-default"><!-- Default panel contents --><div class=panel-heading>Uploaded files</div><div class=panel-body><div class=list-group><div class=list-group-item ng-repeat="f in model.uploaded_files"><i class="fa fa-ban btn" ng-click=deleteFile(f,$index,$event)></i> <a ng-click="downloadFile({{ encodeFileName(f.filename) }})" target=_blank>{{ f.filename }} <span class=badge>{{ f.size }} kb</span></a></div></div></div></div></div></div>'),a.put("components/directives/file-uploads/file-uploads.html",'<div class=row ng-if=!preview><div class=form-group><label class="control-label col-sm-2">Select Files</label><div class=col-sm-8><input type=file ng-file-select=onFileSelect($files) multiple class=form-control></div></div><div class=form-group><label class="control-label col-sm-2"></label><div class=col-sm-8><div class=drop-box ng-file-drop=onFileSelect($files) ng-file-drag-over-class=optional-css-class ng-show=dropSupported>drop files here</div><div ng-file-drop-available="dropSupported=true" ng-show=!dropSupported>HTML5 Drop File is not supported!</div></div></div></div><div class=row><div class=col-sm-6 ng-if=!preview><div class="panel panel-default"><!-- Default panel contents --><div class=panel-heading><div ng-show="selectedFiles != null">Uploading files</div><div ng-show=!selectedFiles>No files selected</div></div><div class=panel-body><div class=row ng-repeat="f in selectedFiles"><div class=col-sm-6><progressbar value=progress[$index]><i>{{ f.name }}</i></progressbar></div><div class=col-sm-2><button ng-show="progress[$index] < 0" ng-click=start($index) class="button ng-hide">Start</button> <button ng-show="hasUploader($index) && progress[$index] < 100" ng-click=abort($index) class="button ng-hide">Abort</button></div></div><button ng-click=upload.abort() ng-show=hasUploadingInProgress() class=form-control>Cancel Upload</button></div></div></div><div ng-class="{\'col-sm-6\': !preview, \'col-sm-12\': preview}"><div class="panel panel-default"><!-- Default panel contents --><div class=panel-heading>Uploaded files</div><div class=panel-body><div class=list-group><div class=list-group-item ng-repeat="f in model.uploaded_files"><i class="fa fa-ban btn" ng-click=deleteFile(f,$index,$event)></i> <a ng-href="/api/orders/download/{{ encodeFileName(f.filename) }}" target=_blank>{{ f.filename }} <span class=badge>{{ f.size }} kb</span></a></div></div></div></div></div></div>'),a.put("components/directives/form/form.html",'<div class="panel panel-default"><!-- Default panel contents --><div class=panel-heading tooltip-placement=right tooltip="Add new form from the list" ng-if=!preview>{{ module }}<div class=pull-right><div class=btn-group dropdown><button type=button class="btn btn-default btn-xs dropdown-toggle" data-toggle>Add <span class=caret></span></button><ul class="dropdown-menu pull-right" role=menu dropdown-menu><li ng-repeat="form in moduleForms"><a href="" ng-click=addForm(form)>Add {{ form.formName }}</a></li><li class=divider restricted-access></li><li restricted-access><a href=# ng-click=addNewForm()>New Form</a></li></ul></div></div></div><div class=panel-heading ng-if=preview>{{ module }}</div><div class=panel-body><accordion close-others=oneAtATime><accordion-group heading={{form.formName}} ng-repeat="form in listOfForms" is-open=$first><accordion-heading><i class="fa fa-ban" ng-click=removeForm(listOfForms,$index,$event) ng-if=!preview></i> <span>{{form.formName}}</span><div class="btn-group-xs pull-right" tooltip-placement=right tooltip="Add new field or delete the {{form.formName}}" ng-if=!preview restricted-access><button type=button class="btn btn-default fa fa-plus" ng-click=addField(form,$event)></button> <button type=button class="btn btn-default fa fa-trash-o" ng-click=deleteForm(form,$event,$index)></button></div></accordion-heading><field ng-model=field.value index=$index ng-field=field ng-repeat="field in form.fields" field-form=form edit=editField(form,field) delete=deleteFormField(form,field,$index) ng-if=!preview></field><div ng-if=preview><div class=form-group ng-repeat="field in form.fields"><label class="col-md-4 control-label">{{ field.title }}</label><div class="form-control-static col-md-8">{{ field.value }}</div></div></div></accordion-group></accordion><div class=warning ng-if="!listOfForms || listOfForms.length==0" class=animate-if>Nothing to show yet</div></div></div>'),a.put("components/directives/new-orders/new-orders.html",'<div class="panel panel-yellow"><div class=panel-heading><div class=row><div class=col-xs-3><i class="fa fa-shopping-cart fa-5x"></i></div><div class="col-xs-9 text-right"><div class=huge>{{ totalOrders }}</div><div>New Orders!</div><div></div></div></div></div><a href="" ng-click="isCollapsed = !isCollapsed"><div class=panel-footer><span class=pull-left>View orders</span> <span class=pull-right><i class="fa fa-arrow-circle-right"></i></span><div class=clearfix></div></div></a><div collapse=!isCollapsed><div class=list-group><a ng-href="/order/detail/{{order._id}}/" class=list-group-item ng-repeat="order in orders">#{{order.po_number}} For: {{order.customer.name}} - Required By {{order.date_required | date}}</a></div></div></div>'),a.put("components/directives/note/note.html",'<h4>Add New Note</h4><form name=form class=form-horizontal role=form novalidate ng-submit=saveNote(form.$valid) ng-class={submitted:submitted}><table class=table><tr><th>Order</th><td><div class=form-group ng-class="{ \'has-error\' : form.order.$invalid || !note.order}"><input name=order ng-model=note.asyncSelected placeholder="Lookup an order" ng-required=true typeahead="(orders.po_number + \', \' + orders.customer.name) for orders in loadOrders($viewValue)" typeahead-loading=loadingLocations typeahead-on-select="selectedOrder($item, $model, $label)" class=form-control> <i ng-show=loadingLocations class="glyphicon glyphicon-refresh"></i><p ng-show="form.order.$invalid && !form.order.$pristine || !note.order" class=help-block>Select Order</p></div></td></tr><tr><th>Note</th><td><div class=form-group ng-class="{ \'has-error\' : form.note.$invalid }"><textarea name=note ng-model=note.content placeholder=Note ng-required=true class=form-control></textarea><p ng-show="form.order.$invalid && !form.order.$pristine || !note.content" class=help-block>Enter Note</p></div></td></tr></table><div class=form-group><div class="col-sm-offset-4 col-sm-8"><button type=submit class="btn btn-default" ng-disabled="form.$invalid || !note.content || !note.order">Save Note</button></div></div></form>'),a.put("components/directives/notes/notes.html",'<div class="panel panel-primary"><div class=panel-heading><div class=row><div class=col-xs-3><i class="fa fa-envelope fa-5x"></i></div><div class="col-xs-9 text-right"><div class=huge>{{ notes.length }}</div><div>New Notes!</div></div></div></div><a href="" ng-click="isCollapsed = !isCollapsed"><div class=panel-footer><span class=pull-left>View notes</span> <span class=pull-right><i class="fa fa-arrow-circle-right"></i></span><div class=clearfix></div></div></a><div collapse=!isCollapsed><div class="chat-panel panel panel-default"><div class=panel-heading><i class="fa fa-comments fa-fw"></i> Recent Notes</div><!-- /.panel-heading --><div class=panel-body><ul class=chat><li class=clearfix ng-class-odd="\'left\'" ng-class-even="\'right\'" ng-repeat="item in notes"><span class=chat-img ng-class-odd="\'pull-left\'" ng-class-even="\'pull-right\'"><img class=img-circle alt="{{ item.from.name }}" src=http://placehold.it/50/55C1E7/fff></span><div class="chat-body clearfix"><div class=header><strong class=primary-font ng-class-odd="\'\'" ng-class-even="\'pull-right\'"><a href="/order/{{ item.order._id }}">{{ item.from.name }} - {{ item.order.po_number }}</a></strong> <small class=text-muted ng-class-odd="\'pull-right\'" ng-class-even="\'\'"><i class="fa fa-clock-o fa-fw"></i> {{ item.posted_on | timeago }}</small></div><p>{{ item.content }}</p></div></li></ul></div><!-- /.panel-body --><div class=panel-footer><note></note></div><!-- /.panel-footer --></div></div></div>'),a.put("components/directives/order/order-accessories/order-accessories.html",'<div class="panel panel-default"><div class=panel-heading>Accessories<div class=pull-right><div class=btn-group><button type=button class="btn btn-default btn-xs" id=add ng-click=addNewAccessory(order)>Add new accesory</button></div></div></div><div class=panel-body><div class=list-group><div class=list-group-item ng-class="" ng-repeat="accesory in order.ordered_accessories"><span class="label pull-right" ng-class="{\'list-group-item-success\': accesory.received, \'list-group-item-warning\': !accesory.received,\'list-group-item-danger\': !accesory.received }">Received {{accesory.items_received || 0}} / {{accesory.quantity}}</span><div class=checkbox><label><div><h4 class=list-group-item-heading>{{accesory.from_manufacturer}}</h4><h6>Date Received: {{accesory.date_received | date}}</h6><p class=list-group-item-text>{{ accesory.description }}</p></div></label></div></div></div></div></div>'),a.put("components/directives/order/order-details/order-details.html","<div field ng-model=order.customer.name ng-field=\"{title:'Customer', type:'text', require: true}\"></div><div field ng-model=order.po_number ng-field=\"{title:'P.O.#', type:'text', require: true}\"></div><div field ng-model=order.date_required ng-field=\"{title:'Required Date', type:'date', require:true, show_options: [{showMinToday:true}]}\"></div><div field ng-model=order.customer.bill_to ng-field=\"{title:'Bill To', type:'text'}\"></div><div field ng-model=order.customer.ship_to ng-field=\"{title:'Ship To', type:'text', require:true}\"></div><div field ng-model=order.customer.email ng-field=\"{title:'Email', type:'email'}\"></div><div field ng-model=order.customer.phone ng-field=\"{title:'Contact Number', type:'text', require: true}\"></div><div field ng-model=order.customer.cell ng-field=\"{title:'Secondary Number', type:'text'}\"></div><div field ng-model=order.customer.is_private ng-field=\"{title:'Is Private', type:'checkbox'}\"></div><div field ng-model=order.doors ng-field=\"{title: 'Doors', type: 'select', require: true, show_options: 'N/A, All Made in Shop, Some Made In Shop, All Ordered'}\"></div><forms module=Order list-of-forms=order.forms></forms>"),a.put("components/directives/order/order-list/order-list.html",'<div class="panel panel-default"><div class=panel-heading><i class="fa fa-{{ listType }} fa-fw"></i> {{ title }}<div class=pull-right ng-if="listFieldsToEdit && !preview"><div class=btn-group><button type=button class="btn btn-default btn-xs" id=add ng-click=addNewField(editableForm)>Add new</button></div></div></div><!-- /.panel-heading --><div class=panel-body><form ng-submit=listSearch({selectedFilter:selectedFilter})><div class=row ng-if=searchFilter><div class=col-sm-12><div class=input-group><div class="input-group-btn search-panel"><button data-toggle=dropdown class="btn btn-default dropdown-toggle" type=button><span id=search_concept>{{ selectedFilter.label || \'Filter by\' }}</span> <span class=caret></span></button><ul role=menu class=dropdown-menu><li ng-repeat="filterBy in searchFilter track by $index"><a href="" ng-click="selectedFilter.text = \'\'; selectedFilter.label = filterBy.label;selectedFilter.query = filterBy.query;selectedFilter.api = filterBy.api;selectedFilter.itemId = null;">{{ filterBy.label }}</a></li></ul></div><input ng-show=!selectedFilter.api ng-model=selectedFilter.text placeholder="select filter by and type search" ng-disabled=!selectedFilter.label class=form-control> <input ng-show=selectedFilter.api placeholder="select filter by and type search" ng-disabled=!selectedFilter.label ng-model=selectedFilter.text typeahead="results.name for results in lookup($viewValue,selectedFilter.api)" typeahead-on-select="selectedResult($item, $model, $label)" typeahead-loading=loadingLocations class=form-control> <i ng-show=loadingLocations class="glyphicon glyphicon-refresh"></i> <span class=input-group-btn><button type=submit class="btn btn-default"><span class="glyphicon glyphicon-search"></span></button></span></div></div><hr></div></form><div class=list-group><a selected-item class=list-group-item ng-repeat="item in quickList | limitTo: itemsLimit()"><ng-transclude></ng-transclude></a></div><a href="" class="btn btn-default btn-block" ng-show=hasMoreItemsToShow() ng-click=showMoreItems()>Load next</a><div class=list-group-item ng-show=!quickList.length><h4 class=list-group-item-heading>Nothing to show</h4></div><!-- /.list-group --></div><div class=panel-footer ng-if=footerForms><div class=row><field ng-model=field.value ng-field=field action=field.action.click ng-repeat="field in footerForm"></field></div></div><div class=panel-footer ng-if=footerForm><div class=input-group><input placeholder="Type your message here..." class="form-control input-sm" id=btn-input ng-model=message> <span class=input-group-btn><button id=btn-chat class="btn btn-warning btn-sm" ng-click=sendMessage()>Send</button></span></div></div><!-- /.panel-body --></div>'),
a.put("components/directives/order/order-notes/order-notes.html",'<div class="panel panel-default"><div class=panel-heading>Notes<div class=pull-right><div class=btn-group><button type=button class="btn btn-default btn-xs" id=add ng-click=addNewNote()>Add new note</button></div></div></div><div class=panel-body><div class=list-group><div class=list-group-item ng-class="{\'list-group-item-success\': note.resolved, \'list-group-item-warning\': !note.resolved}" ng-repeat="note in notes"><div class=row><div class=col-md-10><div class=checkbox><label><div><h4 class=list-group-item-heading>{{ note.from.name }} @ {{ note.posted_on | date }}</h4><p class=list-group-item-text>{{ note.content }}</p></div></label></div></div><div class=col-md-2><button type=button class="btn btn-default btn-xs" restricted-access ng-click=deleteNote($index,note)><span class="glyphicon glyphicon-trash"></span></button></div></div></div></div></div></div>'),a.put("components/directives/order/order-preview/order-preview.html",'<div class="panel panel-default"><div class=panel-heading>Order {{order.po_number}} <span class=pull-right><order-status></order-status><span class="label label-bright" ng-if=order.shipped_date>{{order.shipped_date | date}}</span></span></div><div class=panel-body><table class=table><tbody><tr class=success><th>Customer</th><td>{{order.customer.name}}</td><th>Created by</th><td>{{order.createdBy.name}}</td></tr><tr class=success><th>Bill To</th><td>{{order.customer.bill_to}}</td><th>Ship To</th><td>{{order.customer.ship_to}}</td></tr><tr class=info><th>Email</th><td>{{order.customer.email}}</td><th>Contact Number</th><td>{{order.customer.phone}}</td></tr><tr class=info><th>Secondary Number</th><td>{{order.customer.cell}}</td><th>Doors</th><td>{{order.doors}}</td></tr><tr class=info><th>Date Required</th><td>{{order.date_required | date}}</td><th>Installation Date</th><td>{{(order.installation_date ? order.installation_date : order.date_required) | date:\'dd-M-yyyy\'}}</td></tr></tbody></table><tabset><tab ng-repeat="tab in tabs" heading={{tab.title}} active=tab.active disabled><div ng-include=tab.template></div></tab></tabset><work-log></work-log></div></div>'),a.put("components/directives/order/order-preview/tab-accessories.html","<order-accessories></order-accessories>"),a.put("components/directives/order/order-preview/tab-files.html",'<file-uploads model=order upload-url="/api/orders/{{ order._id }}/upload"></file-uploads>'),a.put("components/directives/order/order-preview/tab-forms.html","<forms module=Order list-of-forms=order.forms></forms>"),a.put("components/directives/order/order-preview/tab-notes.html","<order-notes></order-notes>"),a.put("components/directives/order/order-preview/tab-services.html",'<div class="panel panel-default"><div class=panel-heading>Services<div class=pull-right><div class=btn-group><button type=button class="btn btn-default btn-xs" id=add ng-click=addNewService(order)>Add new service</button></div></div></div><div class=panel-body><div class=list-group><div class=list-group-item class=list-group-item-success><div><h4 class=list-group-item-heading>{{order.po_number}} - Installation <a ng-href=/order/detail/{{order._id}}/print/Installation><span class="glyphicon glyphicon-print"></span></a></h4><p class=list-group-item-text>{{ order.installation_date | date }}</p></div></div><order-services></order-services></div></div></div>'),a.put("components/directives/order/order-services/order-services.html",'<div class=list-group-item ng-class="{\'list-group-item-success\': service.completed, \'list-group-item-warning\': !service.completed && service.approved,\'list-group-item-danger\': !service.completed && !service.approved }" ng-repeat="service in order.services"><span class="label label-default pull-right" ng-if="!service.approved && !service.completed">New, needs approval</span> <span class="label label-warning pull-right" ng-if="service.approved && !service.completed">Not completed</span> <span class="label label-success pull-right" ng-if="service.approved && service.completed">Completed</span><div class=checkbox><div class=row><div class=col-md-11><label><input type=checkbox ng-disabled=service.completed ng-model=service.completed ng-change="completed(order, service)" restricted-access="admin,sales rep" ng-if=service.approved> <input type=checkbox ng-disabled=service.completed ng-model=service.approved ng-change="completed(order, service)" restricted-access="admin,sales rep" ng-if=!service.approved><div><h4 class=list-group-item-heading>{{service.title}} - {{ service.date | date }} <a ng-href=/order/detail/{{order._id}}/print/{{$index}}><span class="glyphicon glyphicon-print"></span></a></h4><h6>Done by {{service.done_by.name}}</h6><p class=list-group-item-text>{{ service.details }}</p></div></label></div><div class=col-md-1><button type=button class="btn btn-default pull-right" aria-label="Left Align" ng-tooltip="delete this service" ng-click="delete(order, $index)" restricted-access ng-if=!service.approved><span class="glyphicon glyphicon-trash" aria-hidden=true></span></button></div></div></div></div>'),a.put("components/directives/services/services.html",'<div class="panel panel-danger"><div class=panel-heading><div class=row><div class=col-xs-3><i class="fa fa-wrench fa-5x"></i></div><div class="col-xs-9 text-right"><div class=huge>{{ totalOrders }}</div><div>New Services!</div><div></div></div></div></div><a href="" ng-click="isCollapsed = !isCollapsed"><div class=panel-footer><span class=pull-left>View services</span> <span class=pull-right><i class="fa fa-arrow-circle-right"></i></span><div class=clearfix></div></div></a><div collapse=!isCollapsed><div class=list-group><div class=list-group-item class=list-group-item-success ng-repeat="order in orders"><div><h4 class=list-group-item-heading><a ng-href=/order/detail/{{order._id}}/Services>#{{order.po_number}} For: {{order.customer.name}} - Required By {{order.date_required | date}}</a></h4></div><order-services></order-services></div></div></div></div>'),a.put("components/directives/shippingList/shippingList.html",'<div class="panel panel-success"><div class=panel-heading>Shipping List <span class=badge>{{ totalOrders }}</span></div><div class=panel-body><div class=list-group ng-repeat="item in orders" ng-animate="\'animate\'"><shipping-list-item item=item ng-show=!item.shipped></shipping-list-item></div></div><div class=panel-footer><pagination total-items=totalOrders ng-model=currentPage page=currentPage max-size=maxSize class=pagination-sm boundary-links=true rotate=false num-pages=numPages></pagination><pre>Page: {{currentPage}} / {{numPages}}</pre></div></div>'),a.put("components/directives/shippingList/shippingListItem.html",'<span class=list-group-item><h4 class="list-group-item-heading active">{{item.po_number}} - {{item.customer.name}}</h4><p class=list-group-item-text><div class=row><div class=col-md-6><div class=form-group><label class="col-md-4 control-label">Ship To:</label><div class="form-control-static col-md-8">{{item.customer.ship_to ? item.customer.ship_to : item.customer.bill_to}}</div></div></div><div class=col-md-6><div class=row><div class=col-md-4>Shipping Date</div><div class=col-md-8><p class=input-group><input class=form-control datepicker-popup={{format}} ng-model=item.shipped_date is-open=opened data-show-weeks=false data-show-today=false datepicker-options=dateOptions ng-required=true close-text="Close"> <span class=input-group-btn><button type=button class="btn btn-default" ng-click=open($event)><i class="glyphicon glyphicon-calendar"></i></button></span></p></div></div></div></div></p></span>'),a.put("components/directives/work-log/work-log.html",'<div class="panel panel-primary"><div class=panel-heading><span class="glyphicon glyphicon-tasks">&nbsp;</span><span>Work Log</span></div><div class=panel-body><div class=panel-group id=accordion role=tablist aria-multiselectable=true><div class="panel panel-default" ng-repeat="item in orders"><div class=panel-heading role=tab id=heading{{$index}}><h4 class=panel-title><a data-toggle=collapse data-parent=#accordion href=#collapse{{$index}}>{{getOrderTitle(item)}}</a></h4></div><div id=collapse{{$index}} class="panel-collapse collapse" role=tabpanel aria-labelledby=heading{{$index}}><div class=panel-body><tabset><tab heading={{form.formName}} ng-repeat="form in item.forms" active=form.active><div class=well><div class=row><div class=col-md-4>To Do<ul class=list-group><li class="list-group-item list-group-item-info" ng-show=!task.status ng-repeat="task in form.tasks | orderBy:\'priority\':false"><span class=pull-right><button ng-click="setTaskStatus(item, $parent.$parent.$index, form, $parent.$index, task, \'in progress\', $event)" class="btn btn-xs"><span class="glyphicon glyphicon-play" aria-hidden=true></span></button></span> {{ task.title }}</li></ul></div><div class=col-md-4>In Progress<ul class=list-group><li class="list-group-item list-group-item-warning" ng-repeat="task in form.tasks | filter:{status:\'in progress\'}"><span class=pull-right><button ng-click="setTaskStatus(item, $parent.$parent.$index, form, $parent.$index, task, \'done\', $event)" class="btn btn-xs"><span class="glyphicon glyphicon-check" aria-hidden=true></span></button></span> {{ task.title }}</li></ul></div><div class=col-md-4>Done<ul class=list-group><li class="list-group-item list-group-item-success" ng-repeat="task in form.tasks | filter:{status:\'done\'}"><span class=pull-right><button ng-click="deleteTaskStatus(item, $parent.$parent.$index, form, $parent.$index, task, $event)" class="btn btn-xs"><span class="glyphicon glyphicon-remove-sign" aria-hidden=true></span></button></span> {{ task.title }}</li></ul></div></div></div></tab></tabset></div></div></div></div><pagination ng-model=currentPage total-items=totalOrders page=currentPage max-size=maxSize class=pagination-sm boundary-links=true rotate=false num-pages=numPages></pagination><pre>Page: {{currentPage}} / {{numPages}}</pre></div></div>'),a.put("components/modal/modal.html",'<div class=modal-header><button ng-if=modal.dismissable type=button ng-click=$dismiss() class=close>&times;</button><h4 ng-if=modal.title ng-bind=modal.title class=modal-title></h4></div><div class=modal-body><p ng-if=modal.text ng-bind=modal.text></p><div ng-if=modal.html ng-bind-html=modal.html></div><form ng-if=modal.form role=form class=form-horizontal><div class=row><div field ng-model=field.value ng-field=field ng-repeat="field in fields"></div>\'</div></form></div><div class=modal-footer><button ng-if=modal.buttons ng-repeat="button in modal.buttons" ng-class=button.classes ng-click=button.click($event) ng-bind=button.text class=btn></button> <button ng-if=!modal.buttons class="btn btn-primary" ng-click=ok()>OK</button> <button ng-if=!modal.buttons class="btn btn-warning" ng-click=cancel()>Cancel</button></div>'),a.put("components/navbar/navbar.html",'<div class="navbar navbar-default navbar-static-top" ng-controller=NavbarCtrl><div class=container><div class=navbar-header><button class=navbar-toggle type=button ng-click="isCollapsed = !isCollapsed"><span class=sr-only>Toggle navigation</span> <span class=icon-bar></span> <span class=icon-bar></span> <span class=icon-bar></span></button> <a href="/" class=navbar-brand>the-boss</a></div><div collapse=isCollapsed class="navbar-collapse collapse" id=navbar-main><ul class="nav navbar-nav"><li ng-hide=!isLoggedIn() ng-repeat="item in menu" ng-class="{active: isActive(item.link)}"><a ng-href={{item.link}}>{{item.title}}</a></li><!-- <li ng-show="isAdmin()" ng-class="{active: isActive(\'/admin\')}"><a href="/admin">Admin</a></li>\n        <li ng-show="isAdmin()" ng-class="{active: isActive(\'/form\')}"><a href="/form">Forms</a></li> --></ul><ul class="nav navbar-nav navbar-right"><li ng-hide=isLoggedIn() ng-class="{active: isActive(\'/login\')}"><a href=/login>Login</a></li><li ng-show=isLoggedIn()><p class=navbar-text>Hello {{ getCurrentUser().name }}</p></li><li alerts></li><li class=dropdown><a class=dropdown-toggle data-toggle=dropdown href=#><i class="fa fa-user fa-fw"></i> <i class="fa fa-caret-down"></i></a><ul class="dropdown-menu pull-right" role=menu><li><a href=/settings><i class="fa fa-user fa-fw"></i> User settings</a></li><li restricted-access=admin><a href=/user><i class="fa fa-gear fa-fw"></i> Users</a></li><li class=divider></li><li><a href="" ng-click=logout()><i class="fa fa-sign-out fa-fw"></i> Logout</a></li></ul></li></ul></div></div></div>')}]);